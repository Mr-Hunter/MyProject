
<!doctype html>
<html class="starting-up" dir="ltr"
    bookmarkbarattached="true" lang="zh">
<head>
<meta charset="utf-8">
<title>新标签页</title>
<!-- Don't scale the viewport in either portrait or landscape mode.
     Note that this means apps will be reflowed when rotated (like iPad).
     If we wanted to maintain position we could remove 'maximum-scale' so
     that we'd zoom out in portrait mode, but then there would be a bunch
     of unusable space at the bottom.
-->
<meta name="viewport"
      content="user-scalable=no, width=device-width, maximum-scale=1.0">

<!-- It's important that this be the first script loaded. -->
<!-- script src="data:application/javascript;base64,Ly8gQ29weXJpZ2h0IChjKSAyMDEyIFRoZSBDaHJvbWl1bSBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlCi8vIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgovKioKICogQGZpbGVvdmVydmlldwogKiBMb2dnaW5nIGluZm8gZm9yIGJlbmNobWFya2luZyBwdXJwb3Nlcy4gU2hvdWxkIGJlIHRoZSBmaXJzdCBqcyBmaWxlIGluY2x1ZGVkLgogKi8KCi8qIFN0YWNrIG9mIGV2ZW50cyB0aGF0IGhhcyBiZWVuIGxvZ2dlZC4gKi8KdmFyIGV2ZW50TG9nID0gW107CgovKioKICogTG9ncyBhbiBldmVudC4KICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50IChjYW4gYmUgYW55IHN0cmluZykuCiAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF9zaG91bGRMb2dUaW1lIElmIHRydWUsIHRoZSBldmVudCBpcyB1c2VkIGZvcgogKiAgICAgYmVuY2htYXJraW5nIGFuZCB0aGUgdGltZSBpcyBsb2dnZWQuIE90aGVyd2lzZSwganVzdCBwdXNoIHRoZSBldmVudCBvbgogKiAgICAgdGhlIGV2ZW50IHN0YWNrLgogKi8KZnVuY3Rpb24gbG9nRXZlbnQobmFtZSwgb3B0X3Nob3VsZExvZ1RpbWUpIHsKICBpZiAob3B0X3Nob3VsZExvZ1RpbWUpCiAgICBjaHJvbWUuc2VuZCgnbWV0cmljc0hhbmRsZXI6bG9nRXZlbnRUaW1lJywgW25hbWVdKTsKICBldmVudExvZy5wdXNoKFtuYW1lLCBEYXRlLm5vdygpXSk7Cn0KCmxvZ0V2ZW50KCdUYWIuTmV3VGFiU2NyaXB0U3RhcnQnLCB0cnVlKTsKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbihlKSB7CiAgbG9nRXZlbnQoJ1RhYi5OZXdUYWJPbmxvYWQnLCB0cnVlKTsKfSk7CmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbihlKSB7CiAgbG9nRXZlbnQoJ1RhYi5OZXdUYWJET01Db250ZW50TG9hZGVkJywgdHJ1ZSk7Cn0pOwo="></script -->

<link rel="stylesheet" href="chrome://resources/css/text_defaults.css">
<style>/* Copyright (c) 2012 The Chromium Authors. All rights reserved.
 * Use of this source code is governed by a BSD-style license that can be
 * found in the LICENSE file. */

ul, li {
  list-style: none;
  padding: 0;
  margin: 0;
}
a {
  text-decoration: none;
}

body {
  /* Don't highlight links when they're tapped. Safari has bugs here that
     show up as flicker when dragging in some situations */
  -webkit-tap-highlight-color: transparent;
  /* Don't allow selecting text - can occur when dragging */
  -webkit-user-select: none;
  background-size: auto 100%;
  margin: 0;
  overflow-x: hidden;
}

/* [hidden] does display:none, but its priority is too low in some cases. */
[hidden] {
  display: none !important;
}

#page-bk {
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;

  background-attachment: fixed;
  background-color: rgba(255,255,255,1);
  //background-image: url(chrome://theme/IDR_THEME_NTP_BACKGROUND?);
  background-size: cover;
  z-index: -1;
}

#top-nav-pane {
  width: 100%;
  height: 50px;
  font-size: 18px;
  line-height: 50px;
  color: #333;
}

#top-nav-pane .btns {
  float: right;
  height: 100%;
  overflow: hidden;
  padding-right: 20px;
}

#top-nav-pane .btns > div {
  height: 24px;
  float: left;
  margin-left: 20px;
  margin-top: 14px;
  cursor: pointer;
}

#settings-btn {
  width: 24px;
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAYCAYAAAC8/X7cAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxMDYxOTJjMC1jZjA2LTk0NDYtOTUwMC02ZmQzYjJiNjM4YzUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDZFRDU2NjAyMzFFMTFFNzlEQ0JGNkY4NTkwODQxQzkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDZFRDU2NUYyMzFFMTFFNzlEQ0JGNkY4NTkwODQxQzkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmEzMTVkOTVjLTBlNzItZDY0ZC04N2I0LTc4NThiNzk2Y2RlMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxMDYxOTJjMC1jZjA2LTk0NDYtOTUwMC02ZmQzYjJiNjM4YzUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7fv4krAAAD90lEQVR42tyYUUhbZxTH/7m5sc40DZ2NGqUhbbaCOjKqDKFMWTuQsq4prH0QVCh7kKaC5GEyW3wY4nCK5MGNuTHsHpzgy7aiw4WNYu2LMobEsDRsDI2FxprV1s6YJTG52bnhJrve3KhZc1964JDLvd/3+75zvnO+831RJZNJ7CEvkVaRHiPVkRaRcqQR0n9IH5MGSMP4f/LcfFUOA3hwNWkl32afSSSFQXzCoAedeEH4cgZUkJ4mZfP0ZpzUQ/pwn3YF5UsNOElacwCv7CVe0uUc3wrOZ0Qf+OWsfU44BEalzHtF+KwoJl8Xt+I4TjU4OHg1GAzWq9XqSElJyXpLS8s3/LfJycm2cDhsTCQSGoPB4O7p6bnFMIx4KXnWU1HMZvETSajOfIurf2yiXsMgcvQQ1j9tQorfdQ9tT6IwxjloLHq4F67glloFWX46hOqE3SAl29vb7NDQkKOsrExvt9t9/ORcLtcJt9ttSjWuq/M3Nzev8n1HR0er19bWQmSEU6vVxkWD8LG6KDzv4m9EwL75HRyv6qH//h34+Ml9sogTt5eR4l+xwP/BaaxyNLX3fkT1/acIzV+Gs7QYWXzeAN47b6eXljxe7HQ6b9bW1obb29tXD7KmExMTxz0ej87hcAwYjcawaPe4Izxn+H8+Q/HZ27h53oTwV2dxIP61uzj+gx+6ny9hoPoodvF5A14RtrSUdHd3DzQ2Nj6y2WzBfAJzenraMDc3VzU8PPyh6LVP+M3wK77GQEcNHvU1IC/+R7/A8PlvqAq+j118Rigi/+1V8fhh8mIw38wym80x6quVvD4m5UcTOFzzMvLmv1GOWCyBLD4rVMCMUNj0j4+P925ubs6zLMuVlpYmrFar7J7t9XrjgUBAo1KpMDMzY21tbe2TNNFJ+1DY9HfMovfhNuYPqcGZdUi8a5avCa4HiHufQMNQ8H38K6xfvIUsPiuU74xQgq7r9fresbGx66FQyNLQ0OAiA2S9QkmdXFhYOEfJ6+/s7LxhsVieSZoUSftQgq5XatHb+hOu/xWBpe0UXGSArFBSJ8d/xzlKXv/UBdw4U4EsPp8DFyT1ICMjIyM2WoEi8qwmR/LubGxsxLq6uqZyrDwnU28ycn4aNlqBIvKsJkfy7vi3EHNdRE4+D45BOYkpzecN2FJwgC2l+YxwZFVKHivNZ4SjalIBePoYrCifES4LAQUGSF9EFOWzoopZLj2jm0ymldnZWfvS0tLfcoRoNHqkqanpyxxnd5+kImfx6wxY+cwD+9QKZPmhHRy59hr25IvvA1XCoasQsihzsVGEz0hOd94CxOv9HLcyRfgv3JXyhbjU7/e3R7rCbin0t0pe/H8FGABU5qRmoCphkAAAAABJRU5ErkJggg==) 0 0 no-repeat;
}
#settings-btn:hover {
  background-position: -24px 0px;
}

#search-section {
  position: relative;
  margin: 0px auto;
  width: 80%;
  max-width: 650px;
  min-width: 380px;
  //height: 200px;
  min-height: 50px;
  max-height: 200px;
  transition: height 0.2s ease-out;
}

#search-logo {
  margin: 0px auto;
  position: absolute;
  bottom: 76px;
  width: 100%;
  transition: all 0.3s;
  opacity: 0;
}
#search-logo > img {
  width: 210px;
  margin: 0px auto;
  display: block;
  -webkit-user-drag: none;
}
#search-form {
  position: absolute;
  bottom: 0px;
  margin-top: 20px;
  width: 100%;
  height: 42px;
}

#search-form .line-controls {
  width: 100%;
  height: 100%;
  display: flex;
  flex-wrap: nowrap;
  opacity: 0.9;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
}

#search-form .line-controls > * {
  height: 100%;
}

#search-input {
  flex-grow: 1;
  padding: 0;
  margin: 0;
  padding-left: 15px;
  font-size: 17px;
  outline: none;
  border: 1px solid #ccc;
  border-right: 0;
  height: calc(100% - 2px) !important;
}

#submit {
  width: 100px;
  border: none;
  font-family: none;
  color: white;
  font-size: 16px;
  cursor: pointer;
  outline: none;
  background: rgb(29, 150, 255);
}

#search-suggestion {
  position: absolute;
  top: calc(100% + 3px);
  background-color: rgba(255, 255, 255, 240);
  z-index: 100;
  text-align: left;
  font-size: 15px;
  border: 1px solid rgba(0, 0, 0, .1);
  margin-left: 0px;
  box-shadow: 0px 10px 15px rgba(0, 0, 0, .2);
}

#search-suggestion a.on, #search-suggestion a:hover {
  background-color: #eaeaea;
}
#search-suggestion a {
  display: block;
  padding-left: 10px;
  width: calc(100% - 10px);
  height: 25px;
  line-height: 25px;
  text-decoration: none;
  color: #111;
}

#search-suggestion em {
  display: inline-block;
  border-radius: 5px;
  width: 20px;
  text-align: center;
  margin: 4px 6px 0px 0px;
  margin-left: 0;
  height: calc(100% - 7px);
  line-height: 15px;
  font-size: 13px;
  color: white;
  background-color: rgb(110, 190, 255);
}
#search-suggestion a:nth-child(1) em {
  background-color: rgb(250, 80, 50);
}
#search-suggestion a:nth-child(2) em {
  background-color: rgb(240, 230, 60);
}
#search-suggestion a:nth-child(3) em {
  background-color: rgb(50, 250, 90);
}

#img-link-section {
  margin: 0px auto;
  width: 95%;
  margin-top: 50px;
}

#img-link-section .tile-layout {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  width: 100%;
}
#img-link-section .tile-layout > div {
  width: 19.8%;
}

#img-link-section .item {
  position: relative;
  margin: 8px auto;
  width: calc(100% - 15px);
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0px 1px 6px rgba(0, 0, 0, 0.3);
}
#img-link-section .item:hover {
  box-shadow: 0px 5px 16px rgba(0, 0, 0, 0.5);
}
#img-link-section .scaling-helper {
  margin-top: 55%;
}
#img-link-section .item .item-content {
  position: absolute;
  left: 0px;
  top: 0px;
  right: 0px;
  bottom: 0px;
}
#img-link-section .img-a, #img-link-section .img-a > img {
  width: 100%;
  cursor: pointer;
}
#img-link-section .no-image-title {
  position: absolute;
  top: 60%;
  left: 50%;
  margin-left: -40%;
  width: 80%;
  box-sizing: border-box;
  padding: 3px 5px;
  text-overflow: ellipsis;
  text-align: center;
  font-size: 15px;
  letter-spacing: 4px;
  white-space: nowrap;
  overflow: hidden;
  color: white;
  text-shadow: 1px 1px 1px black;
}

#img-link-section .item .navbar {
  position: absolute;
  bottom: 0px;
  width: calc(100% + 50px);
  height: 24px;
  line-height: 24px;
  transition: all 0.2s !important;
  background-color: rgba(0, 0, 0, 0);
}
#img-link-section .item:hover .navbar {
  width: 100%;
  background-color: rgba(0, 0, 0, 0.3);
}

#img-link-section .item .navbar .title {
  margin-left: 10px;
  color: white;
  float: left;
  opacity: 0;
  transition: all 0.3s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  width: calc(100% - 60px);
}
#img-link-section a, #img-link-section a:visited {
  color: white;
}
#img-link-section .item:hover .navbar .title {
  opacity: 1;
}

#img-link-section .item .btn-panel {
  position: absolute;
  right: 0px;
  height: 100%;
  overflow: hidden;
}
#img-link-section .item .btn-panel > div {
  width: 25px;
  height: 100%;
  float: left;
  cursor: pointer;
}
#img-link-section .item .btn-panel > div:hover {
  background-color: rgba(0, 0, 0, 0.45);
}
#img-link-section .item .btn-panel .delete-btn {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABySURBVChTfZEBDoAgDAN5Gfgiv8sjfIObK+uSkUyaELL2KqJNRKat0Q5S1Qsc4G7r+SvAZ97DKAuY6TsYgsFgFbBz3sEQAgL3EQwRfLHTqmVAHB1Prr9SAtfRad4LKdjeMfleSEZ5mZQPDPiDx1t7QeYH5urGRHAa37kAAAAASUVORK5CYII=) no-repeat center center;
}
#img-link-section .item .btn-panel .edit-btn {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5MzFFMTExQ0E3MjkxMUU2QjEwQkY4RUZBRDIzNEJDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5MzFFMTExREE3MjkxMUU2QjEwQkY4RUZBRDIzNEJDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkzMUUxMTFBQTcyOTExRTZCMTBCRjhFRkFEMjM0QkMxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjkzMUUxMTFCQTcyOTExRTZCMTBCRjhFRkFEMjM0QkMxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+KtiQLwAAAGpJREFUeNpi/A8EDNgBIxqfDYilWXBIMmBRvAKI3zJCbWAkQjFITTgLESavhLLDgfgXEymKQQwmAor/IyvGpQFZcQSyYpAYNg1TcSiGBCeWUFIE4qfYFIMMIiZYGQg5CS+AxcN/YjUABBgAvfolswkWWA0AAAAASUVORK5CYII=) no-repeat center center;
}


#text-link-section {
  margin: 0px auto;
  width: 95%;
  margin-top: 30px;
}
#img-link-section, #text-link-section {
  min-width: 900px;
  max-width: 1200px;
}

#text-link-pane {
  position: relative;
  width: calc(100% - 15px);
  margin: 0px auto;
  padding-top: 1px;
}

#tab-strip {
  position: absolute;
  width: 100%;
  height: 29px;
  font-size: 15px;
  overflow: hidden;
  border-left: 1px solid #dddddd;
  z-index: 1;
}

#tab-strip .tab {
  width: 10%;
  height: calc(100% - 2px);
  float: left;
  text-align: center;
  line-height: 28px;
  color: #333;
  border-top: 1px solid #dddddd;
  border-right: 1px solid #eee;
  border-bottom: 1px solid #eee;
  cursor: default;
  background-color: rgba(255, 255, 255, .7);
}
#tab-strip .tab.active {
  height: 100%;
  color: #111 !important;
  background-color: rgba(255, 255, 255, 1) !important;
}
#tab-strip .tab.more {
  cursor: pointer;
  border-right: 1px solid #dddddd;
}
#tab-strip .tab:hover {
  text-decoration: underline;
  color: #111;
  background-color: rgba(255, 255, 255, .9);
}
#tab-strip .tab.active:hover, #tab-strip .tab.more:hover {
  text-decoration: none;
}

#tab-strip-shadow {
  height: 26px;
  width: 465px;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, .15);
}

#tab-pages {
  position: relative;
  margin-top: 2px;
  padding: 15px 30px;
  width: calc(100% - 62px);
  height: 90px;
  font-size: 15px;
  border: 1px solid #dddddd;
  background-color: rgba(255, 255, 255, 1);
  box-shadow: 0px 0px 10px rgba(0, 0, 0, .15);
}

#tab-pages ul.tab-page {
  position: absolute;
  margin: 0px auto;
  width: calc(100% - 10px);
  overflow: hidden;
  transition: opacity 0.3s;
  opacity: 0;
  z-index: 0;
}
#tab-pages ul.tab-page.show {
  opacity: 1;
  z-index: 1;
}
#tab-pages ul.tab-page li.url-item {
  float: left;
  width: calc(14% - 10px);
  height: 24px;
  margin-top: 3px;
  margin-bottom: 3px;
  line-height: 25px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}
.url-item a {
  padding-left: 25px;
  text-decoration: none;
  background-position: 2px 75%;
  background-size: 17px;
  background-repeat: no-repeat;
  color: #222;
}

.url-item a:hover {
  text-decoration: underline;
  color: #F50;
}


.top-navigator-colse-btn {
  position: fixed;
  width: 40px;
  height: 30px;
  top: 10px;
  line-height: 30px;
  font-size: 16px;
  text-align: center;
  color: white;
  cursor: pointer;
  z-index: 10000;
}

#theme-settings-pane {
  position: fixed;
  height: 100%;
  width: 300px;
  left: calc(100% + 10px);
  top: 0;
  padding-top: 50px;
  overflow: hidden;
  transition: all 0.3s ease-out;
  cursor: pointer;
  background-color: rgba(0, 0, 0, .8);
  z-index: 9999;
}

#theme-settings-pane.show {
  transform: translate3d(-100%, 0px, 0px);
  cursor: default;
}

#theme-settings-pane > div {
  transition: all 0.5s ease-out;
  opacity: 0;
}
#theme-settings-pane.show > div {
  opacity: 1;
}

#theme-settings-pane .use-theme-pane {
  height: 35px;
  line-height: 35px;
  width: 185px;
  margin: 8px auto;
  overflow: hidden;
  padding: 0px 20px;
  cursor: pointer;
  background-color: rgba(255, 255, 255, 0.4);
}
#theme-settings-pane .use-theme-pane .title {
  height: 100%;
  font-size: 16px;
  float: left;
  color: #eee;
}
#theme-settings-pane .use-theme-pane .btn-img {
  height: 100%;
  width: 43px;
  float: right;
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAYCAYAAABjswTDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAqNJREFUeNq8lz2IGkEUx2fXXTXqEiyEhEgqNaWWFtEUZxXSBNJaBCVF+qSQtEmVRpAUQUh9VQjplCtODwM2WiQgGBCCJBoRCYpc9jNvhl0zt7d3uuu6A39mV2efP9++efMegzwYmqa5Yofb8j1jmje/b5o9Gdw1gKx+bcwMBYilUrMn4JwFKJZPh+SoaxoWA8ogRZcnwJwJlNXh8Oc8yK/PBjCiQCVKMgWtHRqWoTyJ4QKgYCqVEmq12hHM98Ph8G3YKOp6vf45GAzOisXiyWw2W8O6c9BfCvpgwIzJo9iTN0CharWaKZfLb0OhUMLqweVy+Q3+yMtKpfIVbg1oUQfWaOBms7kXZKFQuPTqDdBwr9d7lk6nXzAMw19nRJZl1Ol00Hg8RsFgEAUCAeTz+YjgWbtMOIzOQMeg9/r9BViW2lAYLNhoNB5lMpnKNlASQxyHcrkcikajSBRFAo9zqsO8ihkegN6BTkA3zQsuwCaTSSGfz7+yFUfgwWw2iyRJIrCKouwDbAwM/cEK1ggDvl6vP4RXecuuZezZWCxGYFVVdevEeqxDW3qWSyQSeaeW4/E4AXURFo8nVrBko0F6uuPUaiQSIaBu1gIw7plh/29HRZGdWjVADzlY+qyHhP/LqaHVaoVYlt1sOpfGdytYnNPk0Wj0xanVyWRCYLFchD02w6oGbKlU+gwp6Lddi4vFAk2nU5J3XYT9CDq9yrPicDhctlqt13YL6263i3ieJ7DG6bUnMIZ8elXMKnohcg5H26d+v/8GIKRtFnFebbfbaD6fI7/fT2D3BMVh+Bx0BPrjRSFzqVR0s5DZqUQUBOEuBgHIH3ZLRLfyLrNj8c1Ra1UqbMRdiu9DNIx0X7VJZ1SXQHcKVm2Ndui2hvGiYXTLs/8EGADMtEAjFK1BwQAAAABJRU5ErkJggg==);
  background-position: center;
  background-repeat: no-repeat;
}
#theme-settings-pane .use-theme-pane .btn-img.on {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAYCAYAAABjswTDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAr1JREFUeNrUlztoFEEYx7/Z3dlLzlzu4gPkxBcWFhFLiRAUDCgECwVBS20srCOIBDstNFWKFDZ2aiGoWFgdqAiJVjYJCBLhSHKgRC978S63O7vjN5sZGNfV3O49xIE/s3u3O/z4z873IJxz6NQghEA3hwW9HyQyq8Ej8z+DVWCGvFYz0QCFAm3+DdzqEagCNKUsDRg0QB/FtOtfgK0egBoaINWkgEGD81CunIn8TbndVVgFqiAzqD6jf0c2f3p6zBo6NEqs/iI+ZnBWr/jVxbfOq8kSqy7W8LkNVFNCK6c5UdFg6qXTNt318Xx06wWoLSBR2dzxG0eyRy/fJfbAcNz7nDU+NeYfTThvbn3A2zqqIZ0OHf4TrNi2q6iLqFF53/IQawY+C+U1G+A267CwEsD7SgF8vlV44573deHe6uMz9/Hmhw5sxDwt7CmhZlAnk4JuwgahfOaB521AeZXB3MpQC6DhplC6a/jm9nMPz8odoZKBxME+kJCpRrhTobM+wrrobBPeLecgaeqhxZFJs3Aw9zdYAXm+3W9XuBoEfujsUhXAce3kp9O0d+dPTY1rsEYU9kL7QYCH7m4CB7DkZNKn18KBE/KQxjp7uCNBS34KAnjdM9PHPprdo2c7o9vpyyDpCyUuwom+VuT/jx0qv0IR9GKb5aeHZY2KlsF4FPZJJxIXkaAGHonioJd6Jd8pz8oM5sfBvkY9bd9YAWqCaVHYW+AwaLvJFwnYl7XSxAsNNoj7Zq9I6PQFOMowBawNNJOBY8UaJC3L3eW52371c01LtzwOdg01hrqGmk3rrJBwltI+2L/TgpHidzBbOmwi3c7f+fbs0nNZ0HgK9v8sZLrQg21dItKBfSLgc2+9nKhE7FLDGFd823oK1boBFim+WS+Lb4jpq1Q3oLoEvVOIa2u43taQHrXiHWkYfwowABebTkBs6C5dAAAAAElFTkSuQmCC);
}

#theme-settings-pane .color-pane {
  width: 225px;
  max-height: 225px;
  min-height: 140px;
  height: 25%;
  margin: 10px auto;
  overflow: hidden;
}
#theme-settings-pane .color-item {
  background-color: #fff;
  width: 55px;
  max-height: 55px;
  height: 25%;
  margin: 0px 1px 1px 0px;
  float: left;
  cursor: pointer;
}
#theme-settings-pane .color-item.c0 { background-color: #fff; }
#theme-settings-pane .color-item.c1 { background-color: #eee; }
#theme-settings-pane .color-item.c2 { background-color: #ddd; }
#theme-settings-pane .color-item.c3 { background-color: #ffe; }
#theme-settings-pane .color-item.c4 { background-color: #fef; }
#theme-settings-pane .color-item.c5 { background-color: #eff; }
#theme-settings-pane .color-item.c6 { background-color: #fee; }
#theme-settings-pane .color-item.c7 { background-color: #efe; }
#theme-settings-pane .color-item.c8 { background-color: #eef; }
#theme-settings-pane .color-item.c9 { background-color: #fda; }
#theme-settings-pane .color-item.c10 { background-color: #dfa; }
#theme-settings-pane .color-item.c11 { background-color: #adf; }
#theme-settings-pane .color-item.c12 { background-color: #fe8; }
#theme-settings-pane .color-item.c13 { background-color: #e8f; }
#theme-settings-pane .color-item.c14 { background-color: #8fe; }
#theme-settings-pane .color-item.c15 { background-color: #000; }

#theme-settings-pane .local-img-pane {
  position: relative;
  width: 225px;
  margin: 25px auto;
  height: 60px;
  margin-bottom: 0px;
  background-color: rgba(255, 255, 255, 0.4);
}
#theme-settings-pane .local-img-pane:hover {
  background-color: rgba(255, 255, 255, 0.55);
}
#theme-settings-pane .local-img-pane .select-prompt {
  color: white;
  font-size: 16px;
  line-height: 60px;
  text-align: center;
}
#theme-settings-pane .local-img-pane:hover .select-prompt {
  color: #eee;
}
#image-selector {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0px;
  left: 0px;
  outline: none;
  opacity: 0;
  cursor: pointer;
}
#theme-settings-pane .image-pane {
  width: 225px;
  height: calc(75% - 180px);
  margin: 10px auto;
}

#theme-settings-pane .image-pane > div {
  width: 100%;
  height: 20%;
  min-height: 45px;
  max-height: 125px;
  margin-bottom: 5px;
  overflow: hidden;
}
#theme-settings-pane .image-pane > div > img {
  width: 100%;
  cursor: pointer;
  -webkit-user-drag: none;
}


#edit-url {
  position: fixed;
  background: rgba(0,0,0,.3);
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  z-index: 10000;
}
#edit-url .edit-url-pane {
  position: fixed;
  left: 100px;
  top: 100px;
  width: 400px;
  height: 500px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  overflow: hidden;
  background-color: #eee;
  border: 1px solid #bbb;
  border-radius: 5px;
  transition: all 0.2s !important;
}
#edit-url .edit-url-pane.no-transition {
  transition: none !important;
}

#edit-url .frame {
  overflow: hidden;
  flex-grow: 0;
  height: 26px;
  line-height: 26px;
  cursor: move;
  background-color: #cfcfcf;
}
#edit-url .frame .title {
  float: left;
  margin-left: 10px;
}
#edit-url .frame .close-btn {
  float: right;
  width: 30px;
  height: 100%;
  cursor: default;
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAZCAYAAAAmNZ4aAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozQzJBNTY0MkI1MTUxMUU2QTA1NkM0MzQwM0UzODMwRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozQzJBNTY0M0I1MTUxMUU2QTA1NkM0MzQwM0UzODMwRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjNDMkE1NjQwQjUxNTExRTZBMDU2QzQzNDAzRTM4MzBEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjNDMkE1NjQxQjUxNTExRTZBMDU2QzQzNDAzRTM4MzBEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+YBIkGAAAAKNJREFUeNrslmEKgCAMhV1H0gM6D+iZlsICf+SasxDCwaNgso/G8xEQkVtRh1tUG7zBa8EhhFj11rmRL4YilIZyD/nsc9UA0ch7j0VUFG96kXuonacG9+AWaBWMRmZZaV3ntVbHz5RzxpE5YMnqBu4s0JnrRJ3378CNexMLtVfI5OqekSS3v+Jqyb0W+DTUCh9JLtG93Eva5IL967PBvwOfAgwAQLq31Mq13WAAAAAASUVORK5CYII=);
}
#edit-url .frame .close-btn:hover {
  /*background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAZCAYAAAAmNZ4aAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC9SURBVEhL7ZLBDcIwDEW7DGLUkh1CNmALzjAKQpzTkF8IspBl2Rakh9bSO/krT7E9lJBKD/Ih3nM4nqaQdgOKC/2TPMbbFOK+uxjg5wuJ02MRMdjEPOfLC65H0eYqSvG1zCU9it6cqVmu/4V+1JLcKAW2HXNyhxTYj4vKnVJgF4MmRzmkwCl+/xRFx27AMWoyXjp2LitgPC5mp065XsxJPz27XCeWpA2jXCmuj0rShjZXsR/Xj9jE3VibOJUny59UeNwsBiwAAAAASUVORK5CYII=);*/
  background-color: #f8a;
}
#edit-url .content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  padding: 10px;
}
#edit-url .content > .input-pane {
  flex-grow: 0;
  padding: 10px 10px 0 10px;
  padding-top: 10px;
  display: flex;
  position: relative;
}
#edit-url .input-pane > label {
  flex-grow: 0;
  line-height: 25px;
  padding-right: 10px;
  font-size: 15px;
}
#edit-url .input-pane > input {
  flex-grow: 1;
  font-size: 14px;
  color: black;
  padding-left: 5px;
}
#edit-url .input-pane .prompt {
  position: absolute;
  right: 18px;
  box-shadow: 0px 0px 5px #f00;
  height: 20px;
  line-height: 20px;
  padding: 0px 8px;
  border-radius: 2px;
  margin-top: 3px;
}
#edit-url .content > .url-pane {
  flex-grow: 1;
  display: flex;
  align-items: stretch;
  flex-direction: column;
  margin-top: 10px;
  border: 1px solid #bbb;
}
#edit-url .content > .url-pane .tabs {
  flex-grow: 0;
  display: flex;
  height: 30px;
  line-height: 30px;
  font-size: 15px;
}
#edit-url .content > .url-pane .tabs > div {
  flex-grow: 1;
  text-align: center;
  background-color: #eee;
  cursor: pointer;
}
#edit-url .content > .url-pane .tabs > div.active {
  background-color: #fff;
  cursor: default;
}
#edit-url .content > .url-pane .pages {
  flex-grow: 1;
  background-color: white;
}
#edit-url .pages > div {
  width: 100%;
  height: 292px;
  display: none;
}
#edit-url .pages > div.active {
  display: block;
  overflow-x: hidden;
  overflow-y: auto;
}
#edit-url .pages > div.active .url-item {
  line-height: 25px;
  font-size: 13px;
  padding-left: 30px;
  cursor: pointer;
  display: flex;
}
#edit-url .pages > div.active .url-item .title {
  flex-grow: 1;
  flex-shrink: 1;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
#edit-url .pages > div.active .url-item .delete-btn {
  width: 25px;
  flex-shrink: 0;
  cursor: default;
  background: no-repeat center url(data:image/png;base64,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);
}
#edit-url .pages > div.active .url-item .delete-btn:hover {
  background: no-repeat center url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5MjBFM0E1NDNBQTgxMUU3QTlDRUY2RUIwQkY4M0U0QyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5MjBFM0E1NTNBQTgxMUU3QTlDRUY2RUIwQkY4M0U0QyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjkyMEUzQTUyM0FBODExRTdBOUNFRjZFQjBCRjgzRTRDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjkyMEUzQTUzM0FBODExRTdBOUNFRjZFQjBCRjgzRTRDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+o7CEqwAAAH1JREFUeNrsldEKgDAIRbWfdB/X+s+ezL21UNNiEDThPAn3DHQbMjOMrAUG1xT8XoBYBXL6JKxuRrsHJgBF2AVSemT2TvgCSxIMjwmukkR4XNBLwuGNzBY9e7SSpy/u4F8OuYS2KyXQwpOSO8GmhveS6mXg/HCm4PuCQ4ABAGsWB6lsyZrIAAAAAElFTkSuQmCC);
}

#edit-url .pages > div.active .no-url-prompt {
  margin-top: 30px;
  text-align: center;
  font-size: 18px;
}
#edit-url .btn-pane {
  flex-grow: 0;
}

#edit-url .btn-pane {
  overflow: hidden;
}

#edit-url .btn-pane .inner {
  float: right;
  overflow: hidden;
  padding: 10px;
}

#edit-url .btn-pane .inner > div {
  float: left;
  height: 25px;
  line-height: 25px;
  padding: 0 20px 0 20px;
  margin-right: 10px;
  border-radius: 5px;
  cursor: pointer;
  /*background-color: #ddd;*/
}

#edit-url .cancel-btn {
  background-color: #ddd;
}
#edit-url .cancel-btn:hover {
  background-color: pink;
}
#edit-url .confirm-btn {
  background-color: rgba(29, 150, 255, .5);
}
#edit-url .confirm-btn:hover {
  background-color: rgba(29, 150, 255, 1);
  color: white;
}


#url-tab-selector {
  position: fixed;
  background: rgba(0,0,0,.3);
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  z-index: 10000;
}
#url-tab-selector .url-tab-wrapper {
  position: fixed;
  left: 100px;
  top: 100px;
  width: 400px;
  height: 450px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  overflow: hidden;
  background-color: #eee;
  border: 1px solid #bbb;
  border-radius: 5px;
  transition: all 0.2s !important;
}
#url-tab-selector .url-tab-wrapper.no-transition {
  transition: none !important;
}
#url-tab-selector .frame {
  overflow: hidden;
  flex-grow: 0;
  height: 26px;
  line-height: 26px;
  cursor: move;
  background-color: #cfcfcf;
}
#url-tab-selector .frame .title {
  float: left;
  margin-left: 10px;
}
#url-tab-selector .frame .close-btn {
  float: right;
  width: 30px;
  height: 100%;
  cursor: default;
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAZCAYAAAAmNZ4aAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozQzJBNTY0MkI1MTUxMUU2QTA1NkM0MzQwM0UzODMwRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozQzJBNTY0M0I1MTUxMUU2QTA1NkM0MzQwM0UzODMwRCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjNDMkE1NjQwQjUxNTExRTZBMDU2QzQzNDAzRTM4MzBEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjNDMkE1NjQxQjUxNTExRTZBMDU2QzQzNDAzRTM4MzBEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+YBIkGAAAAKNJREFUeNrslmEKgCAMhV1H0gM6D+iZlsICf+SasxDCwaNgso/G8xEQkVtRh1tUG7zBa8EhhFj11rmRL4YilIZyD/nsc9UA0ch7j0VUFG96kXuonacG9+AWaBWMRmZZaV3ntVbHz5RzxpE5YMnqBu4s0JnrRJ3378CNexMLtVfI5OqekSS3v+Jqyb0W+DTUCh9JLtG93Eva5IL967PBvwOfAgwAQLq31Mq13WAAAAAASUVORK5CYII=);
}
#url-tab-selector .frame .close-btn:hover {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAZCAYAAAAmNZ4aAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC9SURBVEhL7ZLBDcIwDEW7DGLUkh1CNmALzjAKQpzTkF8IspBl2Rakh9bSO/krT7E9lJBKD/Ih3nM4nqaQdgOKC/2TPMbbFOK+uxjg5wuJ02MRMdjEPOfLC65H0eYqSvG1zCU9it6cqVmu/4V+1JLcKAW2HXNyhxTYj4vKnVJgF4MmRzmkwCl+/xRFx27AMWoyXjp2LitgPC5mp065XsxJPz27XCeWpA2jXCmuj0rShjZXsR/Xj9jE3VibOJUny59UeNwsBiwAAAAASUVORK5CYII=);
  background-color: #f8a;
}
#url-tab-selector .client {
  width: calc(100% - 20px);
  margin: 0px auto;
  flex-grow: 1;
}
#url-tab-selector .my-cat-panel {
  width: 100%;
  margin-bottom: 25px;
}
#url-tab-selector .client .title {
  height: 20px;
  line-height: 20px;
  font-size: 15px;
  margin-top: 10px;
}
#url-tab-selector .my-cat-panel {
  min-height: 115px;;
}
#url-tab-selector .my-cats, #url-tab-selector .available-cats{
  display: flex;
  flex-wrap: wrap;
  margin: 5px 10px;
}
#url-tab-selector .my-cats .cat {
  width: calc(25% - 28px);
  margin: 10px;
  font-size: 13px;
  position: relative;
  border: 1px solid #ccc;
  border-radius: 13px;
  text-align: center;
  padding: 3px;
  cursor: default;
}

#url-tab-selector .my-cats .cat > i {
  display: none;
  position: absolute;
  width: 15px;
  height: 15px;
  right: -7px;
  top: -6px;
  border-radius: 50%;
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAA9SURBVHjaZI0xEgAgCMNC//9lwEHkFNlKArVwT8D4J1UgJwBMFW6hP8l0eAtdIYASclbsbcR90YIGeCrWAF43FgULWjttAAAAAElFTkSuQmCC) no-repeat center center;
  background-color: rgba(255, 0, 0, .3);
}
#url-tab-selector .my-cats .cat > i:hover {
  background-color: rgba(255, 0, 0, .7);
}
#url-tab-selector .my-cats .cat:hover > i {
  display: block;
}
#url-tab-selector .my-cats .cat.fixed {
  color: #444;
  background-color: #ddd;
}
#url-tab-selector .my-cats .cat.fixed:hover > i {
  display: none;
}

#url-tab-selector .available-cats .cat {
  width: calc(20% - 24px);
  margin: 8px;
  font-size: 13px;
  position: relative;
  border: 1px solid #ccc;
  border-radius: 13px;
  text-align: center;
  padding: 3px;
  cursor: pointer;
  color: #666;
}
#url-tab-selector .available-cats .cat:hover {
  color: black;
  border: 1px solid #666;
}

#url-tab-selector .btn-pane {
  width: 100%;
  overflow: hidden;
}

#url-tab-selector .btn-pane .inner {
  float: right;
  overflow: hidden;
  padding: 10px;
  margin-bottom: 10px;
}

#url-tab-selector .btn-pane .inner > div {
  float: left;
  height: 25px;
  line-height: 25px;
  padding: 0 20px 0 20px;
  margin-right: 10px;
  border-radius: 5px;
  cursor: pointer;
  /*background-color: #ddd;*/
}
#url-tab-selector .cancel-btn {
  background-color: #ddd;
}
#url-tab-selector .cancel-btn:hover, #url-tab-selector .cancel-btn.highlight {
  background-color: pink;
}
#url-tab-selector .confirm-btn {
  background-color: rgba(29, 150, 255, .5);
}
#url-tab-selector .confirm-btn:hover {
  background-color: rgba(29, 150, 255, 1);
  color: white;
}

body.small-screen #img-link-section, body.small-screen #text-link-section{
  min-width: 800px;
  max-width: 1000px;
}
body.small-screen #search-section {
  max-width: 550px;
}
body.small-screen #search-form {
  height: 33px;
}
body.small-screen #search-input, body.small-screen #submit {
  font-size: 15px;
}
body.small-screen #search-suggestion {
  font-size: 14px;
}
body.small-screen #tab-strip, body.small-screen #tab-pages {
  font-size: 14px;
}</style>

<script>
// Until themes can clear the cache, force-reload the theme stylesheet.
document.write('<link id="themecss" rel="stylesheet" ' +
               'href="chrome://theme/css/new_tab_theme.css?' + Date.now() + '">');
</script>

</head>

<body>
  <div id="page-bk"></div>
  <div id="top-nav-pane">
    <div class="btns">
      <div title="设置皮肤" id="settings-btn"></div>
    </div>
  </div>
  <section id="search-section" hidden>
    <div id="search-logo">
      <img hidefocus="true" src="data:image/png;base64,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" width="270">
    </div>
    <form id="search-form" action="https://www.baidu.com/baidu?ie=utf-8">
      <div class="line-controls">
        <input id="search-input" type="text" placeholder="" autocomplete="off" name="word">
        <button id="submit">百度一下</button>
      </div>
      <div id="search-suggestion" hidden=""></div>
    </form>
  </section>

  <section id="img-link-section">
    <div class="tile-layout">
    </div>
  </section>

  <section id="text-link-section" hidden>
    <div id="text-link-pane">
      <div id="tab-strip">
      </div>
      <div id="tab-strip-shadow"></div>
      <div id="tab-pages">
      </div>
    </div>
  </section>

  <div id="theme-settings-pane">
    <div class="use-theme-pane bkcolor">
      <div class="title">使用主题背景</div>
      <div class="btn-img"></div>
    </div>
    <div class="color-pane">
      <div class="color-item c0" data-color="#fff"></div>
      <div class="color-item c1" data-color="#eee"></div>
      <div class="color-item c2" data-color="#ddd"></div>
      <div class="color-item c3" data-color="#ffe"></div>
      <div class="color-item c4" data-color="#fef"></div>
      <div class="color-item c5" data-color="#eff"></div>
      <div class="color-item c6" data-color="#fee"></div>
      <div class="color-item c7" data-color="#efe"></div>
      <div class="color-item c8" data-color="#eef"></div>
      <div class="color-item c9" data-color="#fda"></div>
      <div class="color-item c10" data-color="#dfa"></div>
      <div class="color-item c11" data-color="#adf"></div>
      <div class="color-item c12" data-color="#fe8"></div>
      <div class="color-item c13" data-color="#e8f"></div>
      <div class="color-item c14" data-color="#8fe"></div>
      <div class="color-item c15" data-color="#000"></div>
    </div>
    <div class="local-img-pane">
      <div class="select-prompt">选择本地图片</div>
      <input type="file" id="image-selector" accept=".jpg,.png"/>
    </div>
    <div class="image-pane">
    </div>
  </div>
  <div id="edit-url" hidden>
    <div class="edit-url-pane no-transition">
      <div class="frame">
        <div class="title" i18n-content="addUrl"></div>
        <div class="close-btn"></div>
      </div>
      <div class="content">
        <div class="input-pane">
          <label i18n-content="urlTitle"></label>
          <input type="text" class="url-title-input" />
          <div class="prompt">不能为空</div>
        </div>
        <div class="input-pane">
          <label i18n-content="urlLink"></label>
          <input type="text" class="url-link-input" />
          <div class="prompt">不能为空</div>
        </div>
        <div class="url-pane">
          <div class="tabs">
            <div class="most-visited active" i18n-content="mostVisited"></div>
            <div class="popular" i18n-content="popular"></div>
            <div class="currently-opened" i18n-content="currentlyOpened"></div>
          </div>
          <div class="pages">
            <div class="most-visited active"></div>
            <div class="popular"></div>
            <div class="currently-opened"></div>
          </div>
        </div>
      </div>
      <div class="btn-pane">
        <div class="inner">
          <div class="confirm-btn" i18n-content="confirm"></div>
          <div class="cancel-btn" i18n-content="cancel"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="url-tab-selector" hidden>
    <div class="url-tab-wrapper no-transition">
      <div class="frame">
        <div class="title">编辑分类</div>
        <div class="close-btn"></div>
      </div>
      <div class="client">
        <div class="my-cat-panel">
          <div class="title">我的分类(最多选择8个) :</div>
          <ul class="my-cats">
          </ul>
        </div>
        <div class="available-cat-panel">
          <div class="title">可选分类 :</div>
          <ul class="available-cats">
          </ul>
        </div>
      </div>
      <div class="btn-pane">
        <div class="inner">
          <div class="confirm-btn" i18n-content="confirm"></div>
          <div class="cancel-btn" i18n-content="cancel"></div>
        </div>
      </div>
    </div>
  </div>

<!-- This is used to measure text in the current locale. It is not visible. -->
<div id="fontMeasuringDiv"></div>
<script>// Copyright 2014 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// Action links are elements that are used to perform an in-page navigation or
// action (e.g. showing a dialog).
//
// They look like normal anchor (<a>) tags as their text color is blue. However,
// they're subtly different as they're not initially underlined (giving users a
// clue that underlined links navigate while action links don't).
//
// Action links look very similar to normal links when hovered (hand cursor,
// underlined). This gives the user an idea that clicking this link will do
// something similar to navigation but in the same page.
//
// They can be created in JavaScript like this:
//
//   var link = document.createElement('a', 'action-link');  // Note second arg.
//
// or with a constructor like this:
//
//   var link = new ActionLink();
//
// They can be used easily from HTML as well, like so:
//
//   <a is="action-link">Click me!</a>
//
// NOTE: <action-link> and document.createElement('action-link') don't work.

/**
 * @constructor
 * @extends {HTMLAnchorElement}
 */
var ActionLink = document.registerElement('action-link', {
  prototype: {
    __proto__: HTMLAnchorElement.prototype,

    /** @this {ActionLink} */
    createdCallback: function() {
      // Action links can start disabled (e.g. <a is="action-link" disabled>).
      this.tabIndex = this.disabled ? -1 : 0;

      if (!this.hasAttribute('role'))
        this.setAttribute('role', 'link');

      this.addEventListener('keydown', function(e) {
        if (!this.disabled && e.key == 'Enter' && !this.href) {
          // Schedule a click asynchronously because other 'keydown' handlers
          // may still run later (e.g. document.addEventListener('keydown')).
          // Specifically options dialogs break when this timeout isn't here.
          // NOTE: this affects the "trusted" state of the ensuing click. I
          // haven't found anything that breaks because of this (yet).
          window.setTimeout(this.click.bind(this), 0);
        }
      });

      function preventDefault(e) {
        e.preventDefault();
      }

      function removePreventDefault() {
        document.removeEventListener('selectstart', preventDefault);
        document.removeEventListener('mouseup', removePreventDefault);
      }

      this.addEventListener('mousedown', function() {
        // This handlers strives to match the behavior of <a href="...">.

        // While the mouse is down, prevent text selection from dragging.
        document.addEventListener('selectstart', preventDefault);
        document.addEventListener('mouseup', removePreventDefault);

        // If focus started via mouse press, don't show an outline.
        if (document.activeElement != this)
          this.classList.add('no-outline');
      });

      this.addEventListener('blur', function() {
        this.classList.remove('no-outline');
      });
    },

    /** @type {boolean} */
    set disabled(disabled) {
      if (disabled)
        HTMLAnchorElement.prototype.setAttribute.call(this, 'disabled', '');
      else
        HTMLAnchorElement.prototype.removeAttribute.call(this, 'disabled');
      this.tabIndex = disabled ? -1 : 0;
    },
    get disabled() {
      return this.hasAttribute('disabled');
    },

    /** @override */
    setAttribute: function(attr, val) {
      if (attr.toLowerCase() == 'disabled')
        this.disabled = true;
      else
        HTMLAnchorElement.prototype.setAttribute.apply(this, arguments);
    },

    /** @override */
    removeAttribute: function(attr) {
      if (attr.toLowerCase() == 'disabled')
        this.disabled = false;
      else
        HTMLAnchorElement.prototype.removeAttribute.apply(this, arguments);
    },
  },

  extends: 'a',
});
</script>
<script>// Copyright (c) 2011 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

/**
 * @fileoverview EventTracker is a simple class that manages the addition and
 * removal of DOM event listeners. In particular, it keeps track of all
 * listeners that have been added and makes it easy to remove some or all of
 * them without requiring all the information again. This is particularly handy
 * when the listener is a generated function such as a lambda or the result of
 * calling Function.bind.
 */

/**
 * The type of the internal tracking entry. TODO(dbeam): move this back to
 * EventTracker.Entry when https://github.com/google/closure-compiler/issues/544
 * is fixed.
 * @typedef {{target: !EventTarget,
 *            eventType: string,
 *            listener: (EventListener|Function),
 *            capture: boolean}}
 */
var EventTrackerEntry;

/**
 * Create an EventTracker to track a set of events.
 * EventTracker instances are typically tied 1:1 with other objects or
 * DOM elements whose listeners should be removed when the object is disposed
 * or the corresponding elements are removed from the DOM.
 * @constructor
 */
function EventTracker() {
  /**
   * @type {Array<EventTrackerEntry>}
   * @private
   */
  this.listeners_ = [];
}

EventTracker.prototype = {
  /**
   * Add an event listener - replacement for EventTarget.addEventListener.
   * @param {!EventTarget} target The DOM target to add a listener to.
   * @param {string} eventType The type of event to subscribe to.
   * @param {EventListener|Function} listener The listener to add.
   * @param {boolean=} opt_capture Whether to invoke during the capture phase.
   */
  add: function(target, eventType, listener, opt_capture) {
    var capture = !!opt_capture;
    var h = {
      target: target,
      eventType: eventType,
      listener: listener,
      capture: capture,
    };
    this.listeners_.push(h);
    target.addEventListener(eventType, listener, capture);
  },

  /**
   * Remove any specified event listeners added with this EventTracker.
   * @param {!EventTarget} target The DOM target to remove a listener from.
   * @param {?string} eventType The type of event to remove.
   */
  remove: function(target, eventType) {
    this.listeners_ = this.listeners_.filter(function(h) {
      if (h.target == target && (!eventType || (h.eventType == eventType))) {
        EventTracker.removeEventListener_(h);
        return false;
      }
      return true;
    });
  },

  /**
   * Remove all event listeners added with this EventTracker.
   */
  removeAll: function() {
    this.listeners_.forEach(EventTracker.removeEventListener_);
    this.listeners_ = [];
  }
};

/**
 * Remove a single event listener given it's tracking entry. It's up to the
 * caller to ensure the entry is removed from listeners_.
 * @param {EventTrackerEntry} h The entry describing the listener to remove.
 * @private
 */
EventTracker.removeEventListener_ = function(h) {
  h.target.removeEventListener(h.eventType, h.listener, h.capture);
};
</script>
<script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// // Copyright (c) 2013 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

/**
 * @fileoverview Assertion support.
 */

/**
 * Verify |condition| is truthy and return |condition| if so.
 * @template T
 * @param {T} condition A condition to check for truthiness.  Note that this
 *     may be used to test whether a value is defined or not, and we don't want
 *     to force a cast to Boolean.
 * @param {string=} opt_message A message to show on failure.
 * @return {T} A non-null |condition|.
 */
function assert(condition, opt_message) {
  if (!condition) {
    var message = 'Assertion failed';
    if (opt_message)
      message = message + ': ' + opt_message;
    var error = new Error(message);
    var global = function() {
      return this;
    }();
    if (global.traceAssertionsForTesting)
      console.warn(error.stack);
    throw error;
  }
  return condition;
}

/**
 * Call this from places in the code that should never be reached.
 *
 * For example, handling all the values of enum with a switch() like this:
 *
 *   function getValueFromEnum(enum) {
 *     switch (enum) {
 *       case ENUM_FIRST_OF_TWO:
 *         return first
 *       case ENUM_LAST_OF_TWO:
 *         return last;
 *     }
 *     assertNotReached();
 *     return document;
 *   }
 *
 * This code should only be hit in the case of serious programmer error or
 * unexpected input.
 *
 * @param {string=} opt_message A message to show when this is hit.
 */
function assertNotReached(opt_message) {
  assert(false, opt_message || 'Unreachable code hit');
}

/**
 * @param {*} value The value to check.
 * @param {function(new: T, ...)} type A user-defined constructor.
 * @param {string=} opt_message A message to show when this is hit.
 * @return {T}
 * @template T
 */
function assertInstanceof(value, type, opt_message) {
  // We don't use assert immediately here so that we avoid constructing an error
  // message if we don't have to.
  if (!(value instanceof type)) {
    assertNotReached(
        opt_message ||
        'Value ' + value + ' is not a[n] ' + (type.name || typeof type));
  }
  return value;
}


/**
 * Alias for document.getElementById. Found elements must be HTMLElements.
 * @param {string} id The ID of the element to find.
 * @return {HTMLElement} The found element or null if not found.
 */
function $(id) {
  // Disable getElementById restriction here, since we are instructing other
  // places to re-use the $() that is defined here.
  // eslint-disable-next-line no-restricted-properties
  var el = document.getElementById(id);
  return el ? assertInstanceof(el, HTMLElement) : null;
}

// TODO(devlin): This should return SVGElement, but closure compiler is missing
// those externs.
/**
 * Alias for document.getElementById. Found elements must be SVGElements.
 * @param {string} id The ID of the element to find.
 * @return {Element} The found element or null if not found.
 */
function getSVGElement(id) {
  // Disable getElementById restriction here, since it is not suitable for SVG
  // elements.
  // eslint-disable-next-line no-restricted-properties
  var el = document.getElementById(id);
  return el ? assertInstanceof(el, Element) : null;
}

/**
 * Add an accessible message to the page that will be announced to
 * users who have spoken feedback on, but will be invisible to all
 * other users. It's removed right away so it doesn't clutter the DOM.
 * @param {string} msg The text to be pronounced.
 */
function announceAccessibleMessage(msg) {
  var element = document.createElement('div');
  element.setAttribute('aria-live', 'polite');
  element.style.position = 'fixed';
  element.style.left = '-9999px';
  element.style.height = '0px';
  element.innerText = msg;
  document.body.appendChild(element);
  window.setTimeout(function() {
    document.body.removeChild(element);
  }, 0);
}

/**
 * Generates a CSS url string.
 * @param {string} s The URL to generate the CSS url for.
 * @return {string} The CSS url string.
 */
function url(s) {
  // http://www.w3.org/TR/css3-values/#uris
  // Parentheses, commas, whitespace characters, single quotes (') and double
  // quotes (") appearing in a URI must be escaped with a backslash
  var s2 = s.replace(/(\(|\)|\,|\s|\'|\"|\\)/g, '\\$1');
  // WebKit has a bug when it comes to URLs that end with \
  // https://bugs.webkit.org/show_bug.cgi?id=28885
  if (/\\\\$/.test(s2)) {
    // Add a space to work around the WebKit bug.
    s2 += ' ';
  }
  return 'url("' + s2 + '")';
}

/**
 * Parses query parameters from Location.
 * @param {Location} location The URL to generate the CSS url for.
 * @return {Object} Dictionary containing name value pairs for URL
 */
function parseQueryParams(location) {
  var params = {};
  var query = unescape(location.search.substring(1));
  var vars = query.split('&');
  for (var i = 0; i < vars.length; i++) {
    var pair = vars[i].split('=');
    params[pair[0]] = pair[1];
  }
  return params;
}

/**
 * Creates a new URL by appending or replacing the given query key and value.
 * Not supporting URL with username and password.
 * @param {Location} location The original URL.
 * @param {string} key The query parameter name.
 * @param {string} value The query parameter value.
 * @return {string} The constructed new URL.
 */
function setQueryParam(location, key, value) {
  var query = parseQueryParams(location);
  query[encodeURIComponent(key)] = encodeURIComponent(value);

  var newQuery = '';
  for (var q in query) {
    newQuery += (newQuery ? '&' : '?') + q + '=' + query[q];
  }

  return location.origin + location.pathname + newQuery + location.hash;
}

/**
 * @param {Node} el A node to search for ancestors with |className|.
 * @param {string} className A class to search for.
 * @return {Element} A node with class of |className| or null if none is found.
 */
function findAncestorByClass(el, className) {
  return /** @type {Element} */ (findAncestor(el, function(el) {
    return el.classList && el.classList.contains(className);
  }));
}

/**
 * Return the first ancestor for which the {@code predicate} returns true.
 * @param {Node} node The node to check.
 * @param {function(Node):boolean} predicate The function that tests the
 *     nodes.
 * @return {Node} The found ancestor or null if not found.
 */
function findAncestor(node, predicate) {
  var last = false;
  while (node != null && !(last = predicate(node))) {
    node = node.parentNode;
  }
  return last ? node : null;
}

function swapDomNodes(a, b) {
  var afterA = a.nextSibling;
  if (afterA == b) {
    swapDomNodes(b, a);
    return;
  }
  var aParent = a.parentNode;
  b.parentNode.replaceChild(a, b);
  aParent.insertBefore(b, afterA);
}

/**
 * Disables text selection and dragging, with optional whitelist callbacks.
 * @param {function(Event):boolean=} opt_allowSelectStart Unless this function
 *    is defined and returns true, the onselectionstart event will be
 *    surpressed.
 * @param {function(Event):boolean=} opt_allowDragStart Unless this function
 *    is defined and returns true, the ondragstart event will be surpressed.
 */
function disableTextSelectAndDrag(opt_allowSelectStart, opt_allowDragStart) {
  // Disable text selection.
  document.onselectstart = function(e) {
    if (!(opt_allowSelectStart && opt_allowSelectStart.call(this, e)))
      e.preventDefault();
  };

  // Disable dragging.
  document.ondragstart = function(e) {
    if (!(opt_allowDragStart && opt_allowDragStart.call(this, e)))
      e.preventDefault();
  };
}

/**
 * Check the directionality of the page.
 * @return {boolean} True if Chrome is running an RTL UI.
 */
function isRTL() {
  return document.documentElement.dir == 'rtl';
}

/**
 * Get an element that's known to exist by its ID. We use this instead of just
 * calling getElementById and not checking the result because this lets us
 * satisfy the JSCompiler type system.
 * @param {string} id The identifier name.
 * @return {!HTMLElement} the Element.
 */
function getRequiredElement(id) {
  return assertInstanceof(
      $(id), HTMLElement, 'Missing required element: ' + id);
}

/**
 * Query an element that's known to exist by a selector. We use this instead of
 * just calling querySelector and not checking the result because this lets us
 * satisfy the JSCompiler type system.
 * @param {string} selectors CSS selectors to query the element.
 * @param {(!Document|!DocumentFragment|!Element)=} opt_context An optional
 *     context object for querySelector.
 * @return {!HTMLElement} the Element.
 */
function queryRequiredElement(selectors, opt_context) {
  var element = (opt_context || document).querySelector(selectors);
  return assertInstanceof(
      element, HTMLElement, 'Missing required element: ' + selectors);
}

// Handle click on a link. If the link points to a chrome: or file: url, then
// call into the browser to do the navigation.
['click', 'auxclick'].forEach(function(eventName) {
  document.addEventListener(eventName, function(e) {
    if (e.button > 1)
      return;  // Ignore buttons other than left and middle.
    if (e.defaultPrevented)
      return;

    var eventPath = e.path;
    var anchor = null;
    if (eventPath) {
      for (var i = 0; i < eventPath.length; i++) {
        var element = eventPath[i];
        if (element.tagName === 'A' && element.href) {
          anchor = element;
          break;
        }
      }
    }

    // Fallback if Event.path is not available.
    var el = e.target;
    if (!anchor && el.nodeType == Node.ELEMENT_NODE &&
        el.webkitMatchesSelector('A, A *')) {
      while (el.tagName != 'A') {
        el = el.parentElement;
      }
      anchor = el;
    }

    if (!anchor)
      return;

    anchor = /** @type {!HTMLAnchorElement} */ (anchor);
    if ((anchor.protocol == 'file:' || anchor.protocol == 'about:') &&
        (e.button == 0 || e.button == 1)) {
      chrome.send('navigateToUrl', [
        anchor.href, anchor.target, e.button, e.altKey, e.ctrlKey, e.metaKey,
        e.shiftKey
      ]);
      e.preventDefault();
    }
  });
});

/**
 * Creates a new URL which is the old URL with a GET param of key=value.
 * @param {string} url The base URL. There is not sanity checking on the URL so
 *     it must be passed in a proper format.
 * @param {string} key The key of the param.
 * @param {string} value The value of the param.
 * @return {string} The new URL.
 */
function appendParam(url, key, value) {
  var param = encodeURIComponent(key) + '=' + encodeURIComponent(value);

  if (url.indexOf('?') == -1)
    return url + '?' + param;
  return url + '&' + param;
}

/**
 * Creates an element of a specified type with a specified class name.
 * @param {string} type The node type.
 * @param {string} className The class name to use.
 * @return {Element} The created element.
 */
function createElementWithClassName(type, className) {
  var elm = document.createElement(type);
  elm.className = className;
  return elm;
}

/**
 * transitionend does not always fire (e.g. when animation is aborted
 * or when no paint happens during the animation). This function sets up
 * a timer and emulate the event if it is not fired when the timer expires.
 * @param {!HTMLElement} el The element to watch for transitionend.
 * @param {number=} opt_timeOut The maximum wait time in milliseconds for the
 *     transitionend to happen. If not specified, it is fetched from |el|
 *     using the transitionDuration style value.
 */
function ensureTransitionEndEvent(el, opt_timeOut) {
  if (opt_timeOut === undefined) {
    var style = getComputedStyle(el);
    opt_timeOut = parseFloat(style.transitionDuration) * 1000;

    // Give an additional 50ms buffer for the animation to complete.
    opt_timeOut += 50;
  }

  var fired = false;
  el.addEventListener('transitionend', function f(e) {
    el.removeEventListener('transitionend', f);
    fired = true;
  });
  window.setTimeout(function() {
    if (!fired)
      cr.dispatchSimpleEvent(el, 'transitionend', true);
  }, opt_timeOut);
}

/**
 * Alias for document.scrollTop getter.
 * @param {!HTMLDocument} doc The document node where information will be
 *     queried from.
 * @return {number} The Y document scroll offset.
 */
function scrollTopForDocument(doc) {
  return doc.documentElement.scrollTop || doc.body.scrollTop;
}

/**
 * Alias for document.scrollTop setter.
 * @param {!HTMLDocument} doc The document node where information will be
 *     queried from.
 * @param {number} value The target Y scroll offset.
 */
function setScrollTopForDocument(doc, value) {
  doc.documentElement.scrollTop = doc.body.scrollTop = value;
}

/**
 * Alias for document.scrollLeft getter.
 * @param {!HTMLDocument} doc The document node where information will be
 *     queried from.
 * @return {number} The X document scroll offset.
 */
function scrollLeftForDocument(doc) {
  return doc.documentElement.scrollLeft || doc.body.scrollLeft;
}

/**
 * Alias for document.scrollLeft setter.
 * @param {!HTMLDocument} doc The document node where information will be
 *     queried from.
 * @param {number} value The target X scroll offset.
 */
function setScrollLeftForDocument(doc, value) {
  doc.documentElement.scrollLeft = doc.body.scrollLeft = value;
}

/**
 * Replaces '&', '<', '>', '"', and ''' characters with their HTML encoding.
 * @param {string} original The original string.
 * @return {string} The string with all the characters mentioned above replaced.
 */
function HTMLEscape(original) {
  return original.replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/"/g, '&quot;')
      .replace(/'/g, '&#39;');
}

/**
 * Shortens the provided string (if necessary) to a string of length at most
 * |maxLength|.
 * @param {string} original The original string.
 * @param {number} maxLength The maximum length allowed for the string.
 * @return {string} The original string if its length does not exceed
 *     |maxLength|. Otherwise the first |maxLength| - 1 characters with '...'
 *     appended.
 */
function elide(original, maxLength) {
  if (original.length <= maxLength)
    return original;
  return original.substring(0, maxLength - 1) + '\u2026';
}

/**
 * Quote a string so it can be used in a regular expression.
 * @param {string} str The source string.
 * @return {string} The escaped string.
 */
function quoteString(str) {
  return str.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g, '\\$1');
}

/**
 * Calls |callback| and stops listening the first time any event in |eventNames|
 * is triggered on |target|.
 * @param {!EventTarget} target
 * @param {!Array<string>|string} eventNames Array or space-delimited string of
 *     event names to listen to (e.g. 'click mousedown').
 * @param {function(!Event)} callback Called at most once. The
 *     optional return value is passed on by the listener.
 */
function listenOnce(target, eventNames, callback) {
  if (!Array.isArray(eventNames))
    eventNames = eventNames.split(/ +/);

  var removeAllAndCallCallback = function(event) {
    eventNames.forEach(function(eventName) {
      target.removeEventListener(eventName, removeAllAndCallCallback, false);
    });
    return callback(event);
  };

  eventNames.forEach(function(eventName) {
    target.addEventListener(eventName, removeAllAndCallCallback, false);
  });
}

//   /* is_ios */

/**
 * @param {!Event} e
 * @return {boolean} Whether a modifier key was down when processing |e|.
 */
function hasKeyModifiers(e) {
  return !!(e.altKey || e.ctrlKey || e.metaKey || e.shiftKey);
}
</script>
<script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

/**
 * The global object.
 * @type {!Object}
 * @const
 */
var global = this;

/** @typedef {{eventName: string, uid: number}} */
var WebUIListener;

/** Platform, package, object property, and Event support. **/
var cr = cr || function() {
  'use strict';

  /**
   * Builds an object structure for the provided namespace path,
   * ensuring that names that already exist are not overwritten. For
   * example:
   * "a.b.c" -> a = {};a.b={};a.b.c={};
   * @param {string} name Name of the object that this file defines.
   * @param {*=} opt_object The object to expose at the end of the path.
   * @param {Object=} opt_objectToExportTo The object to add the path to;
   *     default is {@code global}.
   * @return {!Object} The last object exported (i.e. exportPath('cr.ui')
   *     returns a reference to the ui property of window.cr).
   * @private
   */
  function exportPath(name, opt_object, opt_objectToExportTo) {
    var parts = name.split('.');
    var cur = opt_objectToExportTo || global;

    for (var part; parts.length && (part = parts.shift());) {
      if (!parts.length && opt_object !== undefined) {
        // last part and we have an object; use it
        cur[part] = opt_object;
      } else if (part in cur) {
        cur = cur[part];
      } else {
        cur = cur[part] = {};
      }
    }
    return cur;
  }

  /**
   * Fires a property change event on the target.
   * @param {EventTarget} target The target to dispatch the event on.
   * @param {string} propertyName The name of the property that changed.
   * @param {*} newValue The new value for the property.
   * @param {*} oldValue The old value for the property.
   */
  function dispatchPropertyChange(target, propertyName, newValue, oldValue) {
    var e = new Event(propertyName + 'Change');
    e.propertyName = propertyName;
    e.newValue = newValue;
    e.oldValue = oldValue;
    target.dispatchEvent(e);
  }

  /**
   * Converts a camelCase javascript property name to a hyphenated-lower-case
   * attribute name.
   * @param {string} jsName The javascript camelCase property name.
   * @return {string} The equivalent hyphenated-lower-case attribute name.
   */
  function getAttributeName(jsName) {
    return jsName.replace(/([A-Z])/g, '-$1').toLowerCase();
  }

  /**
   * The kind of property to define in {@code defineProperty}.
   * @enum {string}
   * @const
   */
  var PropertyKind = {
    /**
     * Plain old JS property where the backing data is stored as a "private"
     * field on the object.
     * Use for properties of any type. Type will not be checked.
     */
    JS: 'js',

    /**
     * The property backing data is stored as an attribute on an element.
     * Use only for properties of type {string}.
     */
    ATTR: 'attr',

    /**
     * The property backing data is stored as an attribute on an element. If the
     * element has the attribute then the value is true.
     * Use only for properties of type {boolean}.
     */
    BOOL_ATTR: 'boolAttr'
  };

  /**
   * Helper function for defineProperty that returns the getter to use for the
   * property.
   * @param {string} name The name of the property.
   * @param {PropertyKind} kind The kind of the property.
   * @return {function():*} The getter for the property.
   */
  function getGetter(name, kind) {
    switch (kind) {
      case PropertyKind.JS:
        var privateName = name + '_';
        return function() {
          return this[privateName];
        };
      case PropertyKind.ATTR:
        var attributeName = getAttributeName(name);
        return function() {
          return this.getAttribute(attributeName);
        };
      case PropertyKind.BOOL_ATTR:
        var attributeName = getAttributeName(name);
        return function() {
          return this.hasAttribute(attributeName);
        };
    }

    // TODO(dbeam): replace with assertNotReached() in assert.js when I can coax
    // the browser/unit tests to preprocess this file through grit.
    throw 'not reached';
  }

  /**
   * Helper function for defineProperty that returns the setter of the right
   * kind.
   * @param {string} name The name of the property we are defining the setter
   *     for.
   * @param {PropertyKind} kind The kind of property we are getting the
   *     setter for.
   * @param {function(*, *):void=} opt_setHook A function to run after the
   *     property is set, but before the propertyChange event is fired.
   * @return {function(*):void} The function to use as a setter.
   */
  function getSetter(name, kind, opt_setHook) {
    switch (kind) {
      case PropertyKind.JS:
        var privateName = name + '_';
        return function(value) {
          var oldValue = this[name];
          if (value !== oldValue) {
            this[privateName] = value;
            if (opt_setHook)
              opt_setHook.call(this, value, oldValue);
            dispatchPropertyChange(this, name, value, oldValue);
          }
        };

      case PropertyKind.ATTR:
        var attributeName = getAttributeName(name);
        return function(value) {
          var oldValue = this[name];
          if (value !== oldValue) {
            if (value == undefined)
              this.removeAttribute(attributeName);
            else
              this.setAttribute(attributeName, value);
            if (opt_setHook)
              opt_setHook.call(this, value, oldValue);
            dispatchPropertyChange(this, name, value, oldValue);
          }
        };

      case PropertyKind.BOOL_ATTR:
        var attributeName = getAttributeName(name);
        return function(value) {
          var oldValue = this[name];
          if (value !== oldValue) {
            if (value)
              this.setAttribute(attributeName, name);
            else
              this.removeAttribute(attributeName);
            if (opt_setHook)
              opt_setHook.call(this, value, oldValue);
            dispatchPropertyChange(this, name, value, oldValue);
          }
        };
    }

    // TODO(dbeam): replace with assertNotReached() in assert.js when I can coax
    // the browser/unit tests to preprocess this file through grit.
    throw 'not reached';
  }

  /**
   * Defines a property on an object. When the setter changes the value a
   * property change event with the type {@code name + 'Change'} is fired.
   * @param {!Object} obj The object to define the property for.
   * @param {string} name The name of the property.
   * @param {PropertyKind=} opt_kind What kind of underlying storage to use.
   * @param {function(*, *):void=} opt_setHook A function to run after the
   *     property is set, but before the propertyChange event is fired.
   */
  function defineProperty(obj, name, opt_kind, opt_setHook) {
    if (typeof obj == 'function')
      obj = obj.prototype;

    var kind = /** @type {PropertyKind} */ (opt_kind || PropertyKind.JS);

    if (!obj.__lookupGetter__(name))
      obj.__defineGetter__(name, getGetter(name, kind));

    if (!obj.__lookupSetter__(name))
      obj.__defineSetter__(name, getSetter(name, kind, opt_setHook));
  }

  /**
   * Counter for use with createUid
   */
  var uidCounter = 1;

  /**
   * @return {number} A new unique ID.
   */
  function createUid() {
    return uidCounter++;
  }

  /**
   * Returns a unique ID for the item. This mutates the item so it needs to be
   * an object
   * @param {!Object} item The item to get the unique ID for.
   * @return {number} The unique ID for the item.
   */
  function getUid(item) {
    if (item.hasOwnProperty('uid'))
      return item.uid;
    return item.uid = createUid();
  }

  /**
   * Dispatches a simple event on an event target.
   * @param {!EventTarget} target The event target to dispatch the event on.
   * @param {string} type The type of the event.
   * @param {boolean=} opt_bubbles Whether the event bubbles or not.
   * @param {boolean=} opt_cancelable Whether the default action of the event
   *     can be prevented. Default is true.
   * @return {boolean} If any of the listeners called {@code preventDefault}
   *     during the dispatch this will return false.
   */
  function dispatchSimpleEvent(target, type, opt_bubbles, opt_cancelable) {
    var e = new Event(type, {
      bubbles: opt_bubbles,
      cancelable: opt_cancelable === undefined || opt_cancelable
    });
    return target.dispatchEvent(e);
  }

  /**
   * Calls |fun| and adds all the fields of the returned object to the object
   * named by |name|. For example, cr.define('cr.ui', function() {
   *   function List() {
   *     ...
   *   }
   *   function ListItem() {
   *     ...
   *   }
   *   return {
   *     List: List,
   *     ListItem: ListItem,
   *   };
   * });
   * defines the functions cr.ui.List and cr.ui.ListItem.
   * @param {string} name The name of the object that we are adding fields to.
   * @param {!Function} fun The function that will return an object containing
   *     the names and values of the new fields.
   */
  function define(name, fun) {
    var obj = exportPath(name);
    var exports = fun();
    for (var propertyName in exports) {
      // Maybe we should check the prototype chain here? The current usage
      // pattern is always using an object literal so we only care about own
      // properties.
      var propertyDescriptor =
          Object.getOwnPropertyDescriptor(exports, propertyName);
      if (propertyDescriptor)
        Object.defineProperty(obj, propertyName, propertyDescriptor);
    }
  }

  /**
   * Adds a {@code getInstance} static method that always return the same
   * instance object.
   * @param {!Function} ctor The constructor for the class to add the static
   *     method to.
   */
  function addSingletonGetter(ctor) {
    ctor.getInstance = function() {
      return ctor.instance_ || (ctor.instance_ = new ctor());
    };
  }

  /**
   * Forwards public APIs to private implementations.
   * @param {Function} ctor Constructor that have private implementations in its
   *     prototype.
   * @param {Array<string>} methods List of public method names that have their
   *     underscored counterparts in constructor's prototype.
   * @param {string=} opt_target Selector for target node.
   */
  function makePublic(ctor, methods, opt_target) {
    methods.forEach(function(method) {
      ctor[method] = function() {
        var target = opt_target ?
            // Disable document.getElementById restriction since cr.js should
            // not depend on util.js.
            // eslint-disable-next-line no-restricted-properties
            document.getElementById(opt_target) :
            ctor.getInstance();
        return target[method + '_'].apply(target, arguments);
      };
    });
  }

  /**
   * The mapping used by the sendWithPromise mechanism to tie the Promise
   * returned to callers with the corresponding WebUI response. The mapping is
   * from ID to the PromiseResolver helper; the ID is generated by
   * sendWithPromise and is unique across all invocations of said method.
   * @type {!Object<!PromiseResolver>}
   */
  var chromeSendResolverMap = {};

  /**
   * The named method the WebUI handler calls directly in response to a
   * chrome.send call that expects a response. The handler requires no knowledge
   * of the specific name of this method, as the name is passed to the handler
   * as the first argument in the arguments list of chrome.send. The handler
   * must pass the ID, also sent via the chrome.send arguments list, as the
   * first argument of the JS invocation; additionally, the handler may
   * supply any number of other arguments that will be included in the response.
   * @param {string} id The unique ID identifying the Promise this response is
   *     tied to.
   * @param {boolean} isSuccess Whether the request was successful.
   * @param {*} response The response as sent from C++.
   */
  function webUIResponse(id, isSuccess, response) {
    var resolver = chromeSendResolverMap[id];
    delete chromeSendResolverMap[id];

    if (isSuccess)
      resolver.resolve(response);
    else
      resolver.reject(response);
  }

  /**
   * A variation of chrome.send, suitable for messages that expect a single
   * response from C++.
   * @param {string} methodName The name of the WebUI handler API.
   * @param {...*} var_args Variable number of arguments to be forwarded to the
   *     C++ call.
   * @return {!Promise}
   */
  function sendWithPromise(methodName, var_args) {
    var args = Array.prototype.slice.call(arguments, 1);
    var promiseResolver = new PromiseResolver();
    var id = methodName + '_' + createUid();
    chromeSendResolverMap[id] = promiseResolver;
    chrome.send(methodName, [id].concat(args));
    return promiseResolver.promise;
  }

  /**
   * A map of maps associating event names with listeners. The 2nd level map
   * associates a listener ID with the callback function, such that individual
   * listeners can be removed from an event without affecting other listeners of
   * the same event.
   * @type {!Object<!Object<!Function>>}
   */
  var webUIListenerMap = {};

  /**
   * The named method the WebUI handler calls directly when an event occurs.
   * The WebUI handler must supply the name of the event as the first argument
   * of the JS invocation; additionally, the handler may supply any number of
   * other arguments that will be forwarded to the listener callbacks.
   * @param {string} event The name of the event that has occurred.
   * @param {...*} var_args Additional arguments passed from C++.
   */
  function webUIListenerCallback(event, var_args) {
    var eventListenersMap = webUIListenerMap[event];
    if (!eventListenersMap) {
      // C++ event sent for an event that has no listeners.
      // TODO(dpapad): Should a warning be displayed here?
      return;
    }

    var args = Array.prototype.slice.call(arguments, 1);
    for (var listenerId in eventListenersMap) {
      eventListenersMap[listenerId].apply(null, args);
    }
  }

  /**
   * Registers a listener for an event fired from WebUI handlers. Any number of
   * listeners may register for a single event.
   * @param {string} eventName The event to listen to.
   * @param {!Function} callback The callback run when the event is fired.
   * @return {!WebUIListener} An object to be used for removing a listener via
   *     cr.removeWebUIListener. Should be treated as read-only.
   */
  function addWebUIListener(eventName, callback) {
    webUIListenerMap[eventName] = webUIListenerMap[eventName] || {};
    var uid = createUid();
    webUIListenerMap[eventName][uid] = callback;
    return {eventName: eventName, uid: uid};
  }

  /**
   * Removes a listener. Does nothing if the specified listener is not found.
   * @param {!WebUIListener} listener The listener to be removed (as returned by
   *     addWebUIListener).
   * @return {boolean} Whether the given listener was found and actually
   *     removed.
   */
  function removeWebUIListener(listener) {
    var listenerExists = webUIListenerMap[listener.eventName] &&
        webUIListenerMap[listener.eventName][listener.uid];
    if (listenerExists) {
      delete webUIListenerMap[listener.eventName][listener.uid];
      return true;
    }
    return false;
  }

  return {
    addSingletonGetter: addSingletonGetter,
    createUid: createUid,
    define: define,
    defineProperty: defineProperty,
    dispatchPropertyChange: dispatchPropertyChange,
    dispatchSimpleEvent: dispatchSimpleEvent,
    exportPath: exportPath,
    getUid: getUid,
    makePublic: makePublic,
    PropertyKind: PropertyKind,

    // C++ <-> JS communication related methods.
    addWebUIListener: addWebUIListener,
    removeWebUIListener: removeWebUIListener,
    sendWithPromise: sendWithPromise,
    webUIListenerCallback: webUIListenerCallback,
    webUIResponse: webUIResponse,

    get doc() {
      return document;
    },

    /** Whether we are using a Mac or not. */
    get isMac() {
      return /Mac/.test(navigator.platform);
    },

    /** Whether this is on the Windows platform or not. */
    get isWindows() {
      return /Win/.test(navigator.platform);
    },

    /** Whether this is on chromeOS or not. */
    get isChromeOS() {
      return /CrOS/.test(navigator.userAgent);
    },

    /** Whether this is on vanilla Linux (not chromeOS). */
    get isLinux() {
      return /Linux/.test(navigator.userAgent);
    },

    /** Whether this is on Android. */
    get isAndroid() {
      return /Android/.test(navigator.userAgent);
    },

    /** Whether this is on iOS. */
    get isIOS() {
      return /iPad|iPhone|iPod/.test(navigator.platform);
    }
  };
}();
</script>
<script>// Copyright (c) 2010 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

/**
 * @fileoverview This contains an implementation of the EventTarget interface
 * as defined by DOM Level 2 Events.
 */

/**
 * @typedef {EventListener|function(!Event):*}
 */
var EventListenerType;

cr.define('cr', function() {

  /**
   * Creates a new EventTarget. This class implements the DOM level 2
   * EventTarget interface and can be used wherever those are used.
   * @constructor
   * @implements {EventTarget}
   */
  function EventTarget() {}

  EventTarget.prototype = {
    /**
     * Adds an event listener to the target.
     * @param {string} type The name of the event.
     * @param {EventListenerType} handler The handler for the event. This is
     *     called when the event is dispatched.
     */
    addEventListener: function(type, handler) {
      if (!this.listeners_)
        this.listeners_ = Object.create(null);
      if (!(type in this.listeners_)) {
        this.listeners_[type] = [handler];
      } else {
        var handlers = this.listeners_[type];
        if (handlers.indexOf(handler) < 0)
          handlers.push(handler);
      }
    },

    /**
     * Removes an event listener from the target.
     * @param {string} type The name of the event.
     * @param {EventListenerType} handler The handler for the event.
     */
    removeEventListener: function(type, handler) {
      if (!this.listeners_)
        return;
      if (type in this.listeners_) {
        var handlers = this.listeners_[type];
        var index = handlers.indexOf(handler);
        if (index >= 0) {
          // Clean up if this was the last listener.
          if (handlers.length == 1)
            delete this.listeners_[type];
          else
            handlers.splice(index, 1);
        }
      }
    },

    /**
     * Dispatches an event and calls all the listeners that are listening to
     * the type of the event.
     * @param {!Event} event The event to dispatch.
     * @return {boolean} Whether the default action was prevented. If someone
     *     calls preventDefault on the event object then this returns false.
     */
    dispatchEvent: function(event) {
      if (!this.listeners_)
        return true;

      // Since we are using DOM Event objects we need to override some of the
      // properties and methods so that we can emulate this correctly.
      var self = this;
      event.__defineGetter__('target', function() {
        return self;
      });

      var type = event.type;
      var prevented = 0;
      if (type in this.listeners_) {
        // Clone to prevent removal during dispatch
        var handlers = this.listeners_[type].concat();
        for (var i = 0, handler; handler = handlers[i]; i++) {
          if (handler.handleEvent)
            prevented |= handler.handleEvent.call(handler, event) === false;
          else
            prevented |= handler.call(this, event) === false;
        }
      }

      return !prevented && !event.defaultPrevented;
    }
  };

  // Export
  return {EventTarget: EventTarget};
});
</script>
<script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

cr.define('cr.ui', function() {

  /**
   * Decorates elements as an instance of a class.
   * @param {string|!Element} source The way to find the element(s) to decorate.
   *     If this is a string then {@code querySeletorAll} is used to find the
   *     elements to decorate.
   * @param {!Function} constr The constructor to decorate with. The constr
   *     needs to have a {@code decorate} function.
   */
  function decorate(source, constr) {
    var elements;
    if (typeof source == 'string')
      elements = cr.doc.querySelectorAll(source);
    else
      elements = [source];

    for (var i = 0, el; el = elements[i]; i++) {
      if (!(el instanceof constr))
        constr.decorate(el);
    }
  }

  /**
   * Helper function for creating new element for define.
   */
  function createElementHelper(tagName, opt_bag) {
    // Allow passing in ownerDocument to create in a different document.
    var doc;
    if (opt_bag && opt_bag.ownerDocument)
      doc = opt_bag.ownerDocument;
    else
      doc = cr.doc;
    return doc.createElement(tagName);
  }

  /**
   * Creates the constructor for a UI element class.
   *
   * Usage:
   * <pre>
   * var List = cr.ui.define('list');
   * List.prototype = {
   *   __proto__: HTMLUListElement.prototype,
   *   decorate: function() {
   *     ...
   *   },
   *   ...
   * };
   * </pre>
   *
   * @param {string|Function} tagNameOrFunction The tagName or
   *     function to use for newly created elements. If this is a function it
   *     needs to return a new element when called.
   * @return {function(Object=):Element} The constructor function which takes
   *     an optional property bag. The function also has a static
   *     {@code decorate} method added to it.
   */
  function define(tagNameOrFunction) {
    var createFunction, tagName;
    if (typeof tagNameOrFunction == 'function') {
      createFunction = tagNameOrFunction;
      tagName = '';
    } else {
      createFunction = createElementHelper;
      tagName = tagNameOrFunction;
    }

    /**
     * Creates a new UI element constructor.
     * @param {Object=} opt_propertyBag Optional bag of properties to set on the
     *     object after created. The property {@code ownerDocument} is special
     *     cased and it allows you to create the element in a different
     *     document than the default.
     * @constructor
     */
    function f(opt_propertyBag) {
      var el = createFunction(tagName, opt_propertyBag);
      f.decorate(el);
      for (var propertyName in opt_propertyBag) {
        el[propertyName] = opt_propertyBag[propertyName];
      }
      return el;
    }

    /**
     * Decorates an element as a UI element class.
     * @param {!Element} el The element to decorate.
     */
    f.decorate = function(el) {
      el.__proto__ = f.prototype;
      el.decorate();
    };

    return f;
  }

  /**
   * Input elements do not grow and shrink with their content. This is a simple
   * (and not very efficient) way of handling shrinking to content with support
   * for min width and limited by the width of the parent element.
   * @param {!HTMLElement} el The element to limit the width for.
   * @param {!HTMLElement} parentEl The parent element that should limit the
   *     size.
   * @param {number} min The minimum width.
   * @param {number=} opt_scale Optional scale factor to apply to the width.
   */
  function limitInputWidth(el, parentEl, min, opt_scale) {
    // Needs a size larger than borders
    el.style.width = '10px';
    var doc = el.ownerDocument;
    var win = doc.defaultView;
    var computedStyle = win.getComputedStyle(el);
    var parentComputedStyle = win.getComputedStyle(parentEl);
    var rtl = computedStyle.direction == 'rtl';

    // To get the max width we get the width of the treeItem minus the position
    // of the input.
    var inputRect = el.getBoundingClientRect();  // box-sizing
    var parentRect = parentEl.getBoundingClientRect();
    var startPos = rtl ? parentRect.right - inputRect.right :
                         inputRect.left - parentRect.left;

    // Add up border and padding of the input.
    var inner = parseInt(computedStyle.borderLeftWidth, 10) +
        parseInt(computedStyle.paddingLeft, 10) +
        parseInt(computedStyle.paddingRight, 10) +
        parseInt(computedStyle.borderRightWidth, 10);

    // We also need to subtract the padding of parent to prevent it to overflow.
    var parentPadding = rtl ? parseInt(parentComputedStyle.paddingLeft, 10) :
                              parseInt(parentComputedStyle.paddingRight, 10);

    var max = parentEl.clientWidth - startPos - inner - parentPadding;
    if (opt_scale)
      max *= opt_scale;

    function limit() {
      if (el.scrollWidth > max) {
        el.style.width = max + 'px';
      } else {
        el.style.width = 0;
        var sw = el.scrollWidth;
        if (sw < min) {
          el.style.width = min + 'px';
        } else {
          el.style.width = sw + 'px';
        }
      }
    }

    el.addEventListener('input', limit);
    limit();
  }

  /**
   * Takes a number and spits out a value CSS will be happy with. To avoid
   * subpixel layout issues, the value is rounded to the nearest integral value.
   * @param {number} pixels The number of pixels.
   * @return {string} e.g. '16px'.
   */
  function toCssPx(pixels) {
    if (!window.isFinite(pixels))
      console.error('Pixel value is not a number: ' + pixels);
    return Math.round(pixels) + 'px';
  }

  /**
   * Users complain they occasionaly use doubleclicks instead of clicks
   * (http://crbug.com/140364). To fix it we freeze click handling for
   * the doubleclick time interval.
   * @param {MouseEvent} e Initial click event.
   */
  function swallowDoubleClick(e) {
    var doc = e.target.ownerDocument;
    var counter = Math.min(1, e.detail);
    function swallow(e) {
      e.stopPropagation();
      e.preventDefault();
    }
    function onclick(e) {
      if (e.detail > counter) {
        counter = e.detail;
        // Swallow the click since it's a click inside the doubleclick timeout.
        swallow(e);
      } else {
        // Stop tracking clicks and let regular handling.
        doc.removeEventListener('dblclick', swallow, true);
        doc.removeEventListener('click', onclick, true);
      }
    }
    // The following 'click' event (if e.type == 'mouseup') mustn't be taken
    // into account (it mustn't stop tracking clicks). Start event listening
    // after zero timeout.
    setTimeout(function() {
      doc.addEventListener('click', onclick, true);
      doc.addEventListener('dblclick', swallow, true);
    }, 0);
  }

  return {
    decorate: decorate,
    define: define,
    limitInputWidth: limitInputWidth,
    toCssPx: toCssPx,
    swallowDoubleClick: swallowDoubleClick
  };
});
</script>
<script>// Copyright 2017 The WCT(Wisdom City Times) Authors. All rights reserved.

cr.define('crossOriginHelper', function() {
  var kCallbackFuncKey = 'cb';
  var requestsIdGenerator = 1;

  var taskIds = new Set();

  function buildUrl(url, params, funcName, cbKey) {
    var paramsStr = '';
    for (var key in params) {
      if (typeof params[key] != 'string' &&
          typeof params[key] != 'number' &&
          typeof params[key] != 'boolean')
        continue;

      if (paramsStr.length > 0)
        paramsStr += '&';
      paramsStr += `${key}=${encodeURIComponent(params[key])}`;
    }
    if (paramsStr.length > 0)
      paramsStr += '&';
    paramsStr += `${cbKey?cbKey:kCallbackFuncKey}=${funcName}`;

    var index = url.search(/\?/)
    if (index < 0) {
      return url + '?' + paramsStr;
    } else if (index < url.length - 1) {
      return url + '&' + paramsStr;
    } else {
      return url + paramsStr;
    }
  }

  function get(url, params, callback, cbKey) {
    var requestId = ++requestsIdGenerator;
    var funcName = `crossOriginHelper_${Date.now()}_${requestId}`;
    var taskId = `crossOriginHelper_taskId_${Date.now()}_${requestId}`;

    var scriptEle = cr.doc.createElement('script');
    scriptEle.async = true;
    scriptEle.setAttribute('src', buildUrl(url, params, funcName, cbKey));

    taskIds.add(taskId);

    var internalCallback = (data)=>{
      if (!taskIds.has(taskId))
        return;

      callback(data);
      taskIds.delete(taskId);
    }
    var cleaner = ()=>{
      cr.doc.body.removeChild(scriptEle);
      delete window[funcName];
    }

    window[funcName] = internalCallback;
    scriptEle.onerror = ()=>{
      internalCallback(null);
      cleaner();
    };
    scriptEle.onload = ()=>{
      cleaner();
    };

    cr.doc.body.appendChild(scriptEle);

    return taskId;
  }

  function cancel(taskId) {
    taskIds.delete(taskId);
  }

  return {
    get: get,
    cancel: cancel,
  }
});
</script>
<script>/*
 * Copyright 2016 The Great Maker Authors. All rights reserved.
 */

cr.define('asyncHelper', function() {
  var callbacks = {};
  var nextCallbackID = 1;

  // Call from the front end.
  // Send a message to browser, and register a callback.
  // This callback will be removed after invoking.
  function sendAndReceive(handler, params, callback) {
    if (typeof callback !== 'function') {
      //chrome.send(handler, params);
      // Do nothing.
      return;
    }
    var id = nextCallbackID++;
    callbacks[id] = callback;
    chrome.send('asyncPostMessage', [id, handler, params]);
  }

  // Call from the browser end.
  // Responsable for invoking callbacks registered from |sendAndReceive|,
  // and then removing it.
  function responseWithParams(params) {
    var callback_id = params[0];
    if (callback_id < 1) {
      return;
    }

    var callback_params = params[1];
    if (typeof callbacks[callback_id] === 'function') {
      callbacks[callback_id].apply(null, callback_params);
      delete callbacks[callback_id];
    }
  }

  function removeCallback(params) {
    var callback_id = params[0];
    if (callback_id < 1) {
      return;
    }

    delete callbacks[callback_id];
  }

  var eventHandlers = {};
  function isValidEventAndCallback(event, callback) {
    if (typeof event === 'string' && event.length > 0 &&
        typeof callback === 'function')
      return true;

    return false;
  }
  function addEventListener(event, callback) {
    if (!isValidEventAndCallback(event, callback))
      return;

    if (!eventHandlers.hasOwnProperty(event))
      eventHandlers[event] = [];

    if (eventHandlers[event].includes(callback)) {
      if (eventHandlers[event][eventHandlers[event].length - 1] == callback)
        return;

      eventHandlers[event].splice(eventHandlers[event].indexOf(callback), 1);
    }

    eventHandlers[event].push(callback);

    if (eventHandlers[event].length == 1) {
      chrome.send('asyncRegisterEvent', [event]);
    }
  }

  function removeEventListener(event, callback) {
    if (!isValidEventAndCallback(event, callback))
      return;

    if (!eventHandlers.hasOwnProperty(event))
      return;

    if (!eventHandlers[event].includes(callback))
      return;

    eventHandlers[event].splice(eventHandlers[event].indexOf(callback), 1);

    if (eventHandlers[event].length < 1) {
      delete eventHandlers[event];
      chrome.send('asyncUnregisterEvent', [event]);
    }
  }

  function triggerEvent(params) {
    var event = params[0];
    if (!eventHandlers.hasOwnProperty(event)) {
      console.error('error');
      return;
    }
    var args = params[1];
    for (var i = eventHandlers[event].length - 1; i >= 0; i--) {
      var callback = eventHandlers[event][i];
      callback.apply(null, args);
    }
  }

  return {
    sendAndReceive: sendAndReceive,
    responseWithParams: responseWithParams,
    removeCallback: removeCallback,
    addEventListener: addEventListener,
    removeEventListener: removeEventListener,
    triggerEvent: triggerEvent,
  };
});</script>

<script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// Use an anonymous function to enable strict mode just for this file (which
// will be concatenated with other files when embedded in Chrome

String.prototype.trim = function() {
  return this.replace(/(^\s*)|(\s*$)/g, "");
}

const kWebsite = 'http://tsbrowser.xiangtatech.com';

cr.define('ntp', function() {
  'use strict';

  var searchEngine = {
    action: 'https://www.baidu.com/s?ie=utf-8',
    keywordName: 'wd',
  }
  var urlEditor = null;
  function UrlEditor_() {
    this.callback = null;
    this.editView = null;
    this.container = null;
    this.frameTitlePane = null;
    this.urlTitleInput = null;
    this.urlTitlePrompt = null;
    this.urlLinkInput = null;
    this.urlLinkPrompt = null;

    this.urlTabStrip = null;
    this.urlPageContainer = null;
    this.mostVisitedPage = null;
    this.popularPage = null;
    this.openedPage = null;

    this.startOffsetX = 0;
    this.startOffsetY = 0;

    this.noMostVisitedUrlHtml = `<div class="no-url-prompt">${loadTimeData.getString('no_most_visited_websites')}</div>`;
  }
  UrlEditor_.prototype = {
    initialize: function() {
      var self = this;
      this.editView = cr.doc.getElementById('edit-url');
      this.container = this.editView.querySelector('.edit-url-pane');

      this.frameTitlePane = this.editView.querySelector('.title');

      cr.doc.addEventListener('keydown', function(event) {
        if (event.code == 'Escape')
          self.cancel();
      });
      this.editView.addEventListener('mousedown', function(event) {
        if (event.srcElement == self.editView)
          self.cancel();
      });

      var closeBtn = this.editView.querySelector('.close-btn');
      closeBtn.addEventListener('mousedown', function(event) {
        event.cancelBubble = true;
      })
      closeBtn.addEventListener('click', function(event) {
        self.cancel();
      });
      var cancelBtn = this.editView.querySelector('.cancel-btn');
      cancelBtn.addEventListener('click', function(event) {
        self.cancel();
      });
      var confirmBtn = this.editView.querySelector('.confirm-btn');
      confirmBtn.addEventListener('click', function(event) {
        if (self.urlTitleInput.value.trim().length < 1) {
          self.urlTitlePrompt.hidden = false;
          return;
        }

        var inputtedUrl = self.urlLinkInput.value.trim();
        if (inputtedUrl.length < 1) {
          self.urlLinkPrompt.hidden = false;
          return;
        }

        self.confirm();
      });

      this.urlTitleInput = this.editView.querySelector('.url-title-input');
      this.urlTitleInput.addEventListener('focus', function() {
        self.urlTitlePrompt.hidden = true;
      });
      this.urlLinkInput = this.editView.querySelector('.url-link-input');
      this.urlLinkInput.addEventListener('focus', function() {
        self.urlLinkPrompt.hidden = true;
      });
      this.urlLinkInput.addEventListener('blur', function() {
        var url = this.value.trim();
        if (url.length > 0 && !url.match(/^((http:\/\/)|(https:\/\/))/i))
          this.value = 'http://' + url;
      });

      var promptEle = this.editView.querySelectorAll('.input-pane .prompt');
      this.urlTitlePrompt = promptEle[0];
      this.urlLinkPrompt = promptEle[1];

      window.addEventListener('resize', function() {
        self.moveContainerToCenter();
      })

      var frame = this.editView.querySelector('.frame');
      var mousemoveHandler = function(event) {

        var left = event.clientX - self.startOffsetX;
        left = Math.max(left, -self.container.offsetWidth / 2);
        left = Math.min(left, window.innerWidth - self.container.offsetWidth / 2);
        self.container.style.left = left + 'px';

        var top = event.clientY - self.startOffsetY;
        top = Math.max(top, 0);
        top = Math.min(top, window.innerHeight - 100);
        self.container.style.top = top + 'px';
      };
      var mouseupHandler = function() {
        cr.doc.removeEventListener('mousemove', mousemoveHandler)
        cr.doc.removeEventListener('mouseup', mouseupHandler)

        self.editView.style.cursor = "default";
        self.container.classList.toggle('no-transition', false);
      }
      frame.addEventListener('mousedown', function(event) {
        cr.doc.addEventListener('mousemove', mousemoveHandler);
        cr.doc.addEventListener('mouseup', mouseupHandler);

        self.editView.style.cursor = "move";
        self.container.classList.toggle('no-transition', true);
        self.startOffsetX = event.offsetX;
        self.startOffsetY = event.offsetY;

        event.cancelBubble = true;
        return true;
      })

      this.initURLPane();
      this.moveContainerToCenter();
    },
    initURLPane: function() {
      var self = this;
      this.urlTabStrip = this.editView.getElementsByClassName('tabs')[0];
      this.urlPageContainer = this.editView.getElementsByClassName('pages')[0];
      this.mostVisitedPage = this.urlPageContainer.children[0];
      this.popularPage = this.urlPageContainer.children[1];
      this.openedPage = this.urlPageContainer.children[2];

      this.urlTabStrip.addEventListener('click', function(event) {
        if (event.srcElement.classList.contains('active'))
          return;

        var index = -1;
        var tabItems = self.urlTabStrip.children;
        for (var i = 0; i < tabItems.length; i++) {
          if (tabItems[i] == event.srcElement) {
            index = i;
            break;
          }
        }
        if (index < 0)
          return;

        self.stackPageAtTop(index);
      });

      var getUrlItemForEvent = (event) => {
        if (event.srcElement.classList.contains('url-item'))
          return event.srcElement;
        if (event.srcElement.classList.contains('title') && event.srcElement.parentNode.classList.contains('url-item'))
          return event.srcElement.parentNode;
        return null;
      }
      this.urlPageContainer.addEventListener('click', function(event) {
        var urlItem = getUrlItemForEvent(event);
        if (!urlItem)
          return;

        self.urlTitleInput.value = urlItem.dataset.title;
        self.urlLinkInput.value = urlItem.dataset.url;
      });

      this.urlPageContainer.addEventListener('dblclick', function(event) {
        var urlItem = getUrlItemForEvent(event);
        if (!urlItem)
          return;

        self.urlTitleInput.value = urlItem.dataset.title;
        self.urlLinkInput.value = urlItem.dataset.url;
        self.confirm();
      });

      this.mostVisitedPage.addEventListener('click', function(event) {
        if (!event.srcElement.classList.contains('delete-btn'))
          return;

        var urlItem = event.srcElement.parentNode;
        chrome.send('removeMostVisitedURL', [urlItem.dataset.url]);
        self.mostVisitedPage.removeChild(urlItem);
        if (self.mostVisitedPage.childElementCount == 0) {
          self.mostVisitedPage.innerHTML = self.noMostVisitedUrlHtml;
        }
        event.cancelBubble = true;
      });
    },
    stackPageAtTop: function(index) {
      var tabItems = this.urlTabStrip.children;
      for (var i = 0; i < tabItems.length; i++) {
        tabItems[i].classList.toggle('active', i == index);
      }
      var pageItems = this.urlPageContainer.children;
      for (var i = 0, item; item = pageItems[i]; i++) {
        item.classList.toggle('active', i == index);
      }
    },
    cancel: function() {
      this.hide();
      this.response(false);
    },
    confirm: function() {
      this.hide();
      this.response(true);
    },
    hide: function() {
      this.urlTitlePrompt.hidden = true;
      this.urlLinkPrompt.hidden = true;

      this.container.classList.toggle('no-transition', true);
      this.editView.hidden = true;

    },
    showAndGetUrl: function(frameTitle, title, url, callback) {
      if (typeof callback !== 'function')
        return;

      this.requestUrls();
      this.editView.hidden = false;
      this.frameTitlePane.innerText = frameTitle || loadTimeData.getString('editUrl');
      this.urlTitleInput.value = title || '';
      this.urlLinkInput.value = url || '';
      this.urlTitleInput.focus();
      this.callback = callback;
      this.moveContainerToCenter();
      this.urlTitlePrompt.hidden = true;
      this.urlLinkPrompt.hidden = true;

      var self = this;
      setTimeout(() => {
        self.container.classList.toggle('no-transition', false);
      });
    },
    requestUrls: function() {
      var self = this;
      asyncHelper.sendAndReceive('getURLsForURLEditor', [], function(data) {
        self.buildUrlPages(data);
      });
    },
    buildUrlPages: function(data) {
      var getItemHtml = (url, title, favicon, canBeDeleted) => {
        var backgroundImage = `url(${favicon})`;
        var divStyle = `background-image:${backgroundImage}; background-repeat:no-repeat; background-position: 10px;`;
        var deleteBtnHtml =  canBeDeleted ? '<div class="delete-btn" title="移除这条记录"></div>' : '';
        return `
          <div class="url-item" data-url="${url}" data-title="${title}" style="${divStyle}">
            <div class="title">${title}</div>${deleteBtnHtml}
          </div>`;
      }
      // Builds most visited page.
      var mostVisitedUrls = data['most_visited_urls'];
      var mostVisitedHtml = '';
      if (mostVisitedUrls.length > 0) {
        for (var i = 0, item; item = mostVisitedUrls[i]; i++) {
          mostVisitedHtml += getItemHtml(item.url, item.title, item.favicon, true);
        }
      } else {
        mostVisitedHtml = this.noMostVisitedUrlHtml;
      }
      this.mostVisitedPage.innerHTML = mostVisitedHtml;

      // Build popular page.
      var popularUrls = data['popular_urls'];
      var popularHtml = '';
      for (var i = 0, item; item = popularUrls[i]; i++) {
        popularHtml += getItemHtml(item.url, item.title, item.favicon, false);
      }
      this.popularPage.innerHTML = popularHtml;

      // Build currently opened page.
      var openedUrls = data['currently_opened_urls'];
      var openedHtml = '';
      if (openedUrls.length > 0) {
        for (var i = 0, item; item = openedUrls[i]; i++) {
          openedHtml += getItemHtml(item.url, item.title, item.favicon, false);
        }
      } else {
        openedHtml = `<div class="no-url-prompt">${loadTimeData.getString('only_newtab_page_is_opened')}</div>`;
      }
      this.openedPage.innerHTML = openedHtml;
    },
    moveContainerToCenter: function() {
      if (this.editView.hidden == true)
        return;

      var left = (this.editView.offsetWidth - this.container.offsetWidth) / 2;
      var top = Math.max((this.editView.offsetHeight - this.container.offsetHeight) / 3, 0);
      this.container.style.left = left + 'px';
      this.container.style.top = top + 'px';
    },
    response: function(confirm) {
      if (!confirm)
        return;

      if (typeof this.callback !== 'function')
        return;

      this.callback(this.urlTitleInput.value.trim(), this.urlLinkInput.value.trim());
    }
  };

  var urlTabSelector = null;
  function UrlTabSelector_() {
    this.view = null;
    this.container = null;
    this.myCatsView = null;
    this.availableCatsView = null;
    this.cancelBtn = null;

    this.callback = null;

    // [{catKeyword:string, catTitle:string, isFixed:boolean}]
    this.allCats = null;       // Includes fixed cats
    this.selectedCatKeywords = null;

    this.cancelBtnResetter = null;
  }
  UrlTabSelector_.prototype = {
    initialize: function() {
      var self = this;

      this.view = $('url-tab-selector');
      this.view.addEventListener('mousedown', function(event) {
        if (event.srcElement == self.view)
          self.closeIfNotChanged();
      });
      cr.doc.addEventListener('keydown', function(event) {
        if (event.code == 'Escape')
          self.closeIfNotChanged();
      });
      this.container = this.view.querySelector('.url-tab-wrapper');
      window.addEventListener('resize', function() {
        self.moveContainerToCenter();
      });
      var closeBtn = this.view.querySelector('.close-btn');
      closeBtn.addEventListener('mousedown', function(event) {
        event.cancelBubble = true;
      });
      closeBtn.addEventListener('click', function() {
        self.hide();
      });
      var frame = this.view.querySelector('.frame');
      var mousemoveHandler = function(event) {
        var left = event.clientX - self.startOffsetX;
        left = Math.max(left, -self.container.offsetWidth / 2);
        left = Math.min(left, window.innerWidth - self.container.offsetWidth / 2);
        self.container.style.left = left + 'px';

        var top = event.clientY - self.startOffsetY;
        top = Math.max(top, 0);
        top = Math.min(top, window.innerHeight - 100);
        self.container.style.top = top + 'px';
      };
      var mouseupHandler = function() {
        cr.doc.removeEventListener('mousemove', mousemoveHandler)
        cr.doc.removeEventListener('mouseup', mouseupHandler)

        self.view.style.cursor = "default";
        self.container.classList.toggle('no-transition', false);
      };
      frame.addEventListener('mousedown', function(event) {
        cr.doc.addEventListener('mousemove', mousemoveHandler);
        cr.doc.addEventListener('mouseup', mouseupHandler);

        self.view.style.cursor = "move";
        self.container.classList.toggle('no-transition', true);
        self.startOffsetX = event.offsetX;
        self.startOffsetY = event.offsetY;

        event.cancelBubble = true;
        return true;
      });
      this.cancelBtn = this.view.querySelector('.cancel-btn');
      this.cancelBtn.addEventListener('click', function(event) {
        self.cancel();
      });
      var confirmBtn = this.view.querySelector('.confirm-btn');
      confirmBtn.addEventListener('click', function(event) {
        self.confirm();
      });

      this.myCatsView = this.view.querySelector('.my-cats');
      this.availableCatsView = this.view.querySelector('.available-cats');
      this.addCatsEventListener();
    },
    addCatsEventListener: function() {
      var self = this;
      this.myCatsView.addEventListener('click', function(event) {
        var iEle = event.srcElement;
        if (iEle.tagName != 'I')
          return;
        if (iEle.parentNode.classList.contains('fixed'))
          return;
        self.removeFromMyCats(iEle.parentNode.dataset.cat);
      });

      this.availableCatsView.addEventListener('click', function(event) {
        var iEle = event.srcElement;
        if (iEle.tagName != 'LI' || !iEle.classList.contains('cat'))
          return;
        
        self.addToMyCats(iEle.dataset.cat);
      });
    },
    removeFromMyCats: function(catKeyword) {
      var deleted = false;
      var cats = this.myCatsView.children;
      for (var i = 0, cat; cat = cats[i]; i++) {
        if (!cat.classList.contains('fiex') && cat.dataset.cat == catKeyword) {
          this.myCatsView.removeChild(cat);
          deleted = true;
          break;
        }
      }
      if (!deleted)
        return;

      for (var i = 0, cat; cat = this.allCats[i]; i++) {
        if (cat.catKeyword == catKeyword) {
          var catLiEle = document.createElement('li');
          catLiEle.className = 'cat';
          catLiEle.dataset.cat = catKeyword;
          catLiEle.innerText = cat.catTitle;
          this.availableCatsView.appendChild(catLiEle);
          break;
        }
      }
    },
    addToMyCats: function(catKeyword) {
      if (this.myCatsView.children.length >= 8)
        return;

      var deleted = false;
      var catTitle = null;
      var cats = this.availableCatsView.children;
      for (var i = 0, cat; cat = cats[i]; i++) {
        if (cat.dataset.cat == catKeyword) {
          catTitle = cat.innerText;
          this.availableCatsView.removeChild(cat);
          deleted = true;
          break;
        }
      }
      if (!deleted)
        return;

      var catLiEle = document.createElement('li');
      catLiEle.className = 'cat';
      catLiEle.dataset.cat = catKeyword;
      catLiEle.innerHTML = catTitle + '<i></i>';
      this.myCatsView.appendChild(catLiEle);
    },

    moveContainerToCenter: function() {
      if (this.view.hidden == true)
        return;

      var left = (this.view.offsetWidth - this.container.offsetWidth) / 2;
      var top = Math.max((this.view.offsetHeight - this.container.offsetHeight) / 3, 0);
      this.container.style.left = left + 'px';
      this.container.style.top = top + 'px';
    },
    showSelector: function(allCats, selectedCatKeywords, callback) {
      this.view.hidden = false;
      this.moveContainerToCenter();
      this.callback = callback;

      this.allCats = allCats;
      this.selectedCatKeywords = selectedCatKeywords;
      this.buildCatUi();
    },
    cancel: function() {
      this.hide();
      this.response(false);
    },
    confirm: function() {
      this.hide();
      this.response(true);
    },
    hide: function() {
      this.container.classList.toggle('no-transition', true);
      this.view.hidden = true;
    },
    response: function(confirm) {
      if (!confirm)
        return;

      if (typeof this.callback !== 'function')
        return;

      this.callback(this.getCatsFromUi());
    },
    getCatsFromUi: function() {
      var selectedCatKeywords = [];
      var catLiEles = this.myCatsView.children;
      for (var i = 0, catLiEle; catLiEle = catLiEles[i]; i++) {
        if (!catLiEle.classList.contains('fixed') && catLiEle.dataset.cat)
          selectedCatKeywords.push(catLiEle.dataset.cat);
      }
      return selectedCatKeywords;
    },
    buildCatUi: function() {
      this.myCatsView.innerHTML = '';
      this.availableCatsView.innerHTML = '';
      for (var i = 0, cat; cat = this.allCats[i]; i++) {
        if (cat.isFixed) {
          var catLiEle = document.createElement('li');
          catLiEle.className = 'cat fixed';
          catLiEle.innerHTML = cat.catTitle;
          this.myCatsView.appendChild(catLiEle);
          continue;
        }

        var catLiEle = document.createElement('li');
        catLiEle.className = 'cat';
        catLiEle.dataset.cat = cat.catKeyword;
        catLiEle.innerText = cat.catTitle;
        this.availableCatsView.appendChild(catLiEle);
      }

      for (var i = 0, catKeyword; catKeyword = this.selectedCatKeywords[i]; i++) {
        this.addToMyCats(catKeyword);
      }
    },
    closeIfNotChanged: function() {
      if (this.view.hidden)
        return;

      var selectedCatKeywordsUi = this.getCatsFromUi();
      if (selectedCatKeywordsUi.length != this.selectedCatKeywords.length) {
        this.highLightCancelBtn();
        return;
      }
      for (var i = 0; i < selectedCatKeywordsUi.length; i++) {
        if (selectedCatKeywordsUi[i] != this.selectedCatKeywords[i]) {
          this.highLightCancelBtn();
          return;
        }
      }
      this.cancel();
    },
    highLightCancelBtn: function() {
      var self = this;
      if (this.cancelBtnResetter) {
        clearTimeout(this.cancelBtnResetter);
        this.cancelBtnResetter = null;
      }
      this.cancelBtn.classList.toggle('highlight', true);
      this.cancelBtnResetter = setTimeout(()=>{
        self.cancelBtnResetter = null;
        self.cancelBtn.classList.toggle('highlight', false);
      }, 500);
    }
  };

  /// top navigator {
  var topNavigator = null;
  function TopNavigator_() {
    this.closeBtn = null;
    this.closeBtnClickCallback = null;

    this.useNTPThemeBGColor = true;
    this.ntpThemeBGColor = null;

    this.themeSettings = null;
    this.themeSettingsPane = null;
  }
  TopNavigator_.prototype = {
    initialize: function() {
      var self = this;

      this.closeBtn = document.createElement('div');
      this.closeBtn.hidden = true;
      this.closeBtn.className = 'top-navigator-colse-btn';
      this.closeBtn.innerText = '关闭';
      document.body.appendChild(this.closeBtn);
      document.body.addEventListener('mousedown', ()=>{
        self.hideCloseBtn_();
      });
      this.themeSettingsPane = $('theme-settings-pane');
      $('settings-btn').addEventListener('click', (event)=>{
        self.showSidePane(self.themeSettingsPane,
                          { x: event.clientX, y: event.clientY });
      });

      var useThemePaneEle = this.themeSettingsPane.querySelector('.use-theme-pane');
      useThemePaneEle.addEventListener('click', ()=>{
        var btnImgEle = useThemePaneEle.querySelector('.btn-img');
        var use = !btnImgEle.classList.contains('on');
        chrome.send('setUseNTPThemeBGColor', [use]);
      })

      var colorPaneEle = this.themeSettingsPane.querySelector('.color-pane');
      colorPaneEle.addEventListener('click', (event)=>{
        var colorDivEle = event.srcElement;
        if (!colorDivEle.classList.contains('color-item'))
          return;

        chrome.send('setColor', [colorDivEle.dataset.color || '#fff']);
        chrome.send('setUseNTPThemeBGColor', [false]);
      });
      $('image-selector').addEventListener('change', (event)=>{
        var path = $('image-selector').value.trim();
        if (!path)
          return;
        var file = $('image-selector').files[0];

        if ((path.match(/.png$/i) || path.match(/.jpg$/i)) &&
            file.size <= 20 * Math.pow(2, 20)) {
          var fr = new FileReader();
          fr.onload = (processEvent)=>{
            if (processEvent.target.result) {
              chrome.send('setLocalImage', [processEvent.target.result]);
              chrome.send('setUseNTPThemeBGColor', [false]);
            }
          };
          fr.readAsDataURL(file);
        }
        $('image-selector').value = '';
      });
      var imagePaneEle = this.themeSettingsPane.querySelector('.image-pane');
      imagePaneEle.addEventListener('click', (event)=>{
        var imgEle = event.srcElement;
        if (imgEle.tagName != 'IMG')
          return;

        chrome.send('setImage', [(imgEle.dataset.index || 0) - 0]);
        chrome.send('setUseNTPThemeBGColor', [false]);
      });
      var imagePaneInnerHTML = '';
      var imageCount = 4;
      for (var i = 0; i < 4; i++) {
        var src = `src="images/bk/thumbnail/${i + 1}.png"`;
        imagePaneInnerHTML += `<div><img data-index='${i}' ${src}/></div>`;
      }
      imagePaneEle.innerHTML = imagePaneInnerHTML;

    },
    showSidePane: function(pane, closeBtnPosition) {
      if (!pane)
        return;

      if (pane.setCancelBubble_ != true) {
        pane.setCancelBubble_ = true;
        pane.addEventListener('mousedown', (e)=>{
          e.cancelBubble = true;
        });
      }

      pane.classList.toggle('show', true);
      this.showCloseBtn_(closeBtnPosition, ()=>{
        pane.classList.toggle('show', false);
      })
    },
    showCloseBtn_: function(point, clickCallback) {
      this.closeBtnClickCallback = clickCallback;
      this.closeBtn.hidden = false;
      var right = document.documentElement.clientWidth - point.x;
      right = Math.max(5, right - (this.closeBtn.offsetWidth / 2));
      this.closeBtn.style.right = right + 'px';
    },
    hideCloseBtn_: function() {
      this.closeBtn.hidden = true;
      if (typeof this.closeBtnClickCallback === 'function') {
        this.closeBtnClickCallback();
        this.closeBtnClickCallback = null;
      }
    },
    setNewThemeSettings:  function(themeSettings) {
      this.themeSettings = themeSettings;
      if (this.useNTPThemeBGColor)
        return;

      var bk = $('page-bk')
      switch (themeSettings[0]) {
        case 0:
          bk.style.backgroundColor = themeSettings[1];
          bk.style.backgroundImage = 'none';
          break;
        case 1:
          bk.style.backgroundImage = `url(${themeSettings[1]})`;
          bk.style.backgroundColor = 'none';
          break;
        case 2:
          // base64
          bk.style.backgroundImage = `url(${themeSettings[1]})`;
          bk.style.backgroundColor = 'none';
      }
    },
    setUseNTPThemeBGColor: function(use) {
      this.useNTPThemeBGColor = use;

      var btnImgEle = this.themeSettingsPane.querySelector('.btn-img');
      btnImgEle.classList.toggle('on', use);

      if (use) {
        var bk = $('page-bk');
        if (this.ntpThemeBGColor) {
          bk.style.backgroundColor = this.ntpThemeBGColor;
          bk.style.backgroundImage = 'none';
        }
        asyncHelper.sendAndReceive('getNTPThemeBackgroundColor', [], (data)=>{
          bk.style.backgroundColor = data;
          bk.style.backgroundImage = 'none';
        })
      } else {
        if (this.themeSettings) {
          this.setNewThemeSettings(this.themeSettings);
        }
      }
    },
  };
  /// }

  function setBookmarkBarAttached(attached) {
    //document.documentElement.setAttribute('bookmarkbarattached', attached);
  }


  function updateSearchEngine() {
    $('search-form').action = searchEngine.action;
    $('search-input').name = searchEngine.keywordName;
  }
  function getSearchEngineFromRadio() {
    var radios = cr.doc.getElementsByName('search_engine');
    for (var i = 0; i < radios.length; i++) {
      if (radios[i].checked) {
        return radios[i].value;
      }
    }
  }

  function getSearchURLForKeyword(keyword) {
    var action = searchEngine.action;
    if (searchEngine.useAccount && searchEngine.account)
      action = searchEngine.action + `&tn=${searchEngine.account}`;

    return action + '&' + searchEngine.keywordName + '=' + encodeURIComponent(keyword);
  }

  function onSearchSubmitClick(e) {
    var keyword = $('search-input').value.trim();
    if (keyword.length < 1) {
      e.preventDefault();
      e.stopPropagation();
      return;
    }

    var url = getSearchURLForKeyword(keyword);
    chrome.send('beginSearch', [keyword, url]);
    window.location = url;
  }

  function defaultSuggestionBuilder(data) {
    var keywords = data.s;
    if (keywords.length < 1) {
      return '';
    }
    var keywordsHTML = '';
    for (var i = 0; i < keywords.length; i++) {
      var keyword = keywords[i];
      var url = getSearchURLForKeyword(keyword);
      keywordsHTML += `<a href="${url}" data-fill="${keyword}">${keyword.replace('&', '&amp;')}</a>`;
    }
    return keywordsHTML;
  }
  function suggestionAvailable(data, innerHTMLBuilder) {

    var builder = typeof innerHTMLBuilder === 'function' ? innerHTMLBuilder
                                                         : defaultSuggestionBuilder;
    var keywordsHTML = builder(data);
    if (!keywordsHTML)
      return;

    var searchSuggestion = $('search-suggestion');
    searchSuggestion.innerHTML = keywordsHTML;
    searchSuggestion.hidden = false;
    searchSuggestion.style.width = ($('search-input').offsetWidth - 2) + 'px';
  }

  var requestTaskId = null;
  var cachedHostSugs = null;
  function requestHotSuggestion() {
    var showHotSuggestion = (hotSugs) => {
      suggestionAvailable(hotSugs, function(data) {
        var hotSugs = data;
        if (hotSugs.length < 1) {
          return '';
        }
        var hotSugHTML = '';
        for (var i = 0, hotSug; (i < 10) && (hotSug = hotSugs[i]); i++) {
          hotSugHTML += `<a href="${hotSug[1]}" data-fill="${hotSug[0]}"><em>${i+1}</em>${hotSug[0]}</a>`;
        }
        return hotSugHTML;
      });
    }
    if (cachedHostSugs) {
      showHotSuggestion(cachedHostSugs)
      return;
    }

    requestTaskId = crossOriginHelper.get(kWebsite + '/sevice/hotsug',
                                          { bversion: tsbrowser.getVersion() },
                                          function(data) {
      showHotSuggestion(data);
      if (data)
        cachedHostSugs = data;
    });
  }

  var lastRequestKeyword = '';
  function onSearchInput() {
    var keyword = $('search-input').value.trim();
    if (!keyword) {
      // Reset lastRequestKeyword.
      lastRequestKeyword = '';

      asyncHelper.sendAndReceive('getPrefsValue',
                                 ['browser.should_show_hot_suggestion'],
                                 (show)=>{
        if (show && !$('search-input').value.trim())
          requestHotSuggestion();
      });
      return;
    }
    
    if (keyword == lastRequestKeyword && !$('search-suggestion').hidden)
      return;

    var url = 'http://suggestion.baidu.com/su?ie=utf-8&action=json';
    requestTaskId = crossOriginHelper.get(url, { wd: keyword }, function(data) {
      suggestionAvailable(data);
    });
    lastRequestKeyword = keyword;
  }

  function cancelRequestHotSuggetionOrKeyword() {
    if (requestTaskId) {
      crossOriginHelper.cancel(requestTaskId);
      requestTaskId = null;
    }
  }

  // true : down
  // false: up
  function onSuggestionNav(isDown) {
    var aEles = $('search-suggestion').children;
    if (aEles.length < 1)
      return;

    var index = isDown ? -1 : 0;
    for (var i = 0; i < aEles.length; i++) {
      var aEle = aEles[i];
      if (aEle.classList.contains('on')) {
        aEle.classList.toggle('on', false);
        index = i;
        break;
      }
    }
    index += isDown ? 1 : -1;
    index = (index + aEles.length) % aEles.length;
    aEles[index].classList.toggle('on', true);
    $('search-input').value = aEles[index].dataset['fill'];
  }

  function onSearchInputKeydown(event) {
    switch (event.key) {
      case 'ArrowUp':
        if (!$('search-suggestion').hidden)
          onSuggestionNav(false);
        event.stopPropagation();
        event.preventDefault();
        break;
      case 'ArrowDown':
        if (!$('search-suggestion').hidden)
          onSuggestionNav(true);
        else
          onSearchInput();
        event.stopPropagation();
        event.preventDefault();
        break;
      default:
        break;
    }
  }

  function onMousedownForSearchInput(e) {
    if (e.button != 0) {
      return;
    }
    var searchSuggestion = $('search-suggestion');
    if (e.target.id == 'search-input' || e.target == searchSuggestion ||
        searchSuggestion.contains(e.target))
      return;

    cancelRequestHotSuggetionOrKeyword();
    $('search-suggestion').hidden = true;
  }
  function initSearch() {
    var searchForm = $('search-form');
    searchForm.onsubmit = ()=>{return false;};

    var searchInput = $('search-input');
    //searchInput.placeholder = 'Search';
    searchInput.autocomplete = 'off';
    searchInput.addEventListener('input', onSearchInput);
    searchInput.addEventListener('keydown', onSearchInputKeydown);
    searchInput.addEventListener('mousedown', onSearchInput);
    document.addEventListener('mousedown', onMousedownForSearchInput);
    window.addEventListener('blur', function() {
      cancelRequestHotSuggetionOrKeyword();
      $('search-suggestion').hidden = true;
    });

    var submit = $('submit');
    //submit.innerText = loadTimeData.getString('search');
    submit.onclick = onSearchSubmitClick;

    var searchSuggestion = $('search-suggestion');
    searchSuggestion.hidden = true;

    searchSuggestion.addEventListener('click', function(e) {
      if (!$('search-input').value.trim())
        return;
      if (e.srcElement.tagName === 'A') {
        chrome.send('beginSearch', [e.srcElement.dataset['fill'], e.srcElement.href]);
      }
    });
    updateSearchEngine();
  }

  /// image link section {
  var imageLinkSection = null;
  function ImageLinkSection() {
    var el = new Object();
    el.__proto__ = ImageLinkSection.prototype;
    el.initialize();

    return el;
  }
  ImageLinkSection.prototype = {
    __proto__: Object.prototype,

    initialize: function() {

    },
    // data: obj {
    //   url,
    //   imageUrl,
    //   title,
    // }
    initImageLinkTileItem: function (tileItem, data) {
      var itemContent = document.createElement('div');
      itemContent.className = 'item-content img-item';
      itemContent.dataset.title = data.title;
      itemContent.dataset.url = data.url;
      var imgAEle = document.createElement('a');
      imgAEle.className = 'img-a';
      imgAEle.href = data.url;
      var imgEle = document.createElement('img');
      imgEle.src = data.imageUrl;
      imgAEle.appendChild(imgEle);
      if (data.isDefaultImage) {
        var noImageTitleDivEle = document.createElement('div');
        noImageTitleDivEle.className = 'no-image-title';
        noImageTitleDivEle.innerText = data.title;
        imgAEle.appendChild(noImageTitleDivEle);
      }
      itemContent.appendChild(imgAEle);
      var navbarEle = document.createElement('div');
      navbarEle.className = 'navbar';
      // var titleEle = document.createElement('div');
      // titleEle.className = 'title';
      // titleEle.innerHTML = `<a href="${data.url}">${data.title}</a>`;
      var titleAEle = document.createElement('a');
      titleAEle.href = data.url;
      titleAEle.innerHTML = `<div class="title">${data.title}</div>`;

      var btnPanelEle = document.createElement('div');
      btnPanelEle.className = 'btn-panel';
      var editBtnEle = document.createElement('div');
      editBtnEle.className = 'edit-btn';
      editBtnEle.dataset.url = data.url;
      editBtnEle.title = '修改网址';
      editBtnEle.dataset.title = data.title;
      var self = this;
      editBtnEle.addEventListener('click', function() {
        var deleteUrl = this.dataset.url;
        var title = this.dataset.title;
        var type = this.dataset.type - 0;
        self.replaceImageLink(this, deleteUrl, title);
      })
      var deleteBtnEle = document.createElement('div');
      deleteBtnEle.className = 'delete-btn';
      deleteBtnEle.title = '删除网址';
      deleteBtnEle.dataset.url = data.url;
      deleteBtnEle.addEventListener('click', function() {
        chrome.send('removeImageLink', [this.dataset.url]);
        // asyncHelper.sendAndReceive('removeImageLink', [this.dataset.url], (args)=>{
        //   self.updateImageLink(args);
        // })
      });
      btnPanelEle.appendChild(editBtnEle);
      btnPanelEle.appendChild(deleteBtnEle);
      navbarEle.appendChild(titleAEle);
      navbarEle.appendChild(btnPanelEle);
      itemContent.appendChild(navbarEle);

      var item = document.createElement('div');
      item.className = 'item';
      var scalingHelper = document.createElement('div');
      scalingHelper.className = 'scaling-helper';
      item.appendChild(scalingHelper);
      item.appendChild(itemContent);
      tileItem.innerHTML = '';
      tileItem.appendChild(item);
      return tileItem;
    },
    getTileLayout: function() {
      return $('img-link-section').querySelector('.tile-layout');
    },
    updateImageLink: function (imageLinks) {
      var TileLayout = this.getTileLayout();
      TileLayout.innerHTML = '';
      for (var i = 0, length = imageLinks.length; i < 10 && i < length; i++) {
        var imageLink = imageLinks[i];
        TileLayout.appendChild(
            this.initImageLinkTileItem(document.createElement('div'), {
          url: imageLink['url'],
          imageUrl: imageLink['img_src'],
          title: imageLink['title'],
          isDefaultImage: imageLink['is_default_img'],
        }));
      }
    },
    replaceImageLink: function(sender, url, title) {
      var self = this;
      var curTile = this.getTileForDescendant(sender);
      this.getEditURL(function(newTitle, newUrl) {
        if (newUrl.length < 1)
          return;
        if (url == newUrl && title == newTitle)
          return;

        var addIndex = Math.max(0, self.getTileGridIndex(sender));
        chrome.send('replaceImageLink', [newTitle, newUrl, addIndex, url]);
        // asyncHelper.sendAndReceive('replaceImageLink',
        //     [newTitle, newUrl, addIndex, url], (args)=>{
        //   self.updateImageLink(args);
        // });
      }, {
        frameTitle: loadTimeData.getString('editUrl'),
        title: title,
        url: url,
      });
    },
    getEditURL: function(callback, params) {
      urlEditor.showAndGetUrl(params.frameTitle, params.title, params.url, callback);
    },
    getTileGridIndex: function(tileOrDescendant) {
      var index = -1;
      var tile = this.getTileForDescendant(tileOrDescendant);
      if (!tile)
        return index;

      var tileLayout = this.getTileLayout();
      var tiles = tileLayout.children;
      for (var i = 0, ele; ele = tiles[i]; i++) {
        if (ele == tile) {
          index = i;
          break;
        }
      }
      return index;
    },
    getTileForDescendant: function(tileOrDescendant) {
      var tileLayout = this.getTileLayout();
      if (tileLayout.children.length < 1)
        return null;

      var tile = null;
      while (tileOrDescendant &&
             tileOrDescendant.tagName != 'BODY' &&
             tileOrDescendant != tileLayout &&
             !tileOrDescendant.classList.contains('item')) {
        tileOrDescendant = tileOrDescendant.parentNode;
      }

      tile = tileOrDescendant;
      if (tile && tile.classList.contains('item'))
        return tile.parentNode;

      return null;
    },
  }
  /// }

  /// text link section {
  var textLinkSection = null;
  function TextLinkSection() {
    var el = new Object();
    el.tabStrip = null;
    el.tabPages = null;
    el.textLinkCats = null;
    el.selectedCatKeywords = null;
    el.currentCatKeyword = null;
    el.succeededToBuildFromCached = false;
    el.__proto__ = TextLinkSection.prototype;
    el.initialize();

    return el;
  }
  TextLinkSection.prototype = {
    __proto__: Object.prototype,

    initialize: function() {
      this.tabStrip = $('tab-strip');
      var self = this;
      this.tabStrip.addEventListener('mousemove', function(event) {
        var tab = event.srcElement;
        if (!tab.classList.contains('tab') || tab.classList.contains('active'))
          return;

        if (tab.classList.contains('more')) {
          //self.openTabSettings();
          return;
        }
        self.showTabPage(tab.dataset.cat);
      });

      this.tabStrip.addEventListener('click', function(event) {
        var tab = event.srcElement;
        if (tab.classList.contains('tab') && tab.classList.contains('more'))
          self.openTabSettings();
      });
      this.tabPages = $('tab-pages');
    },
    openTabSettings: function() {
      // var allCats = [
      //   {catKeyword:'fsdf1', catTitle:'sfsdf1', isFixed:true},
      // ];
      // var selectedCatKeywords = ['fsdf3', 'fsdf5']
      var allCats = [];
      var catKeywords = this.textLinkCats['cat_keywords'];
      for (var i = 0, catKeyword; catKeyword = catKeywords[i]; i++) {
        allCats.push({
          catKeyword: catKeyword,
          catTitle:this.textLinkCats[catKeyword]['cat_title'],
          isFixed: this.textLinkCats[catKeyword]['is_fixed']
        });
      }

      var self = this;
      urlTabSelector.showSelector(allCats, this.selectedCatKeywords,
                                  function(selectedCatKeywords) {
        self.updateSelectedCats(false, selectedCatKeywords);
        chrome.send('setSelectedCats', [selectedCatKeywords]);
      });
    },
    showTimeoutHandle: null,
    showTabPage: function(cat) {
      if (this.showTimeoutHandle) {
        clearTimeout(this.showTimeoutHandle);
        this.showTimeoutHandle = null;
      }
      if (!cat)
        cat = this.tabStrip.children[0].dataset.cat;

      localStorage.setItem('currentSelectedCat', cat);

      for (var i = 0, tab; tab = this.tabStrip.children[i]; i++) {
        if (tab.classList.contains('tab')) {
          tab.classList.toggle('active', cat == tab.dataset.cat);
        }
      }

      var pageToShow = null;
      for (var i = 0, tabPage; tabPage = this.tabPages.children[i]; i++) {
        if (tabPage.classList.contains('tab-page')) {
          tabPage.classList.toggle('show', false);
          if (!pageToShow && tabPage.dataset.cat == cat)
            pageToShow = tabPage;
        }
      }
      if (pageToShow) {
        pageToShow.classList.toggle('show', true);
        return;
      }

      // If there is no page to show build a new one.
      var pageUlEle = document.createElement('ul');
      pageUlEle.className = 'tab-page';
      pageUlEle.dataset.cat = cat;
      var innerHTML = '';
      var links = this.textLinkCats[cat]['text_links'];
      for (var i = 0, link; link = links[i]; i++) {
        innerHTML += `<li class="url-item"><a href="${link['url']}" title="${link['title']}" ` +
                     `style="background-image:url(${link['icon_url']})">${link['title']}</a></li>`;
      }
      pageUlEle.innerHTML = innerHTML;
      this.tabPages.appendChild(pageUlEle);
      var self = this;
      this.showTimeoutHandle = setTimeout(()=>{
        self.showTimeoutHandle = null;
        pageUlEle.classList.toggle('show', true);
      }, 20);
    },
    updateTextLinkTabStripShadow: function() {
      var tabs = this.tabStrip.children;
      var updateInternal = ()=>{
        var totalWidth = 0;
        for (var i = 0, tab; tab = tabs[i]; i++) {
          totalWidth += tab.offsetWidth;
        }
        $('tab-strip-shadow').style.width = totalWidth + 'px';
      }
      updateInternal();
      setTimeout(updateInternal, 200);
    },
    checkSelected_: function() {
      var checkedSelected = [];
      for (var i = 0, catKeyword; catKeyword = this.selectedCatKeywords[i]; i++) {
        if (!this.textLinkCats[catKeyword])
          continue;
        checkedSelected.push(catKeyword);
      }
      this.selectedCatKeywords = checkedSelected;
    },
    build: function() {
      this.checkSelected_();
      this.tabPages.innerHTML = '';
      var fixedCatKeywords = [];
      var catKeywords = this.textLinkCats['cat_keywords'];
      for (var i = 0, catKeyword; catKeyword = catKeywords[i]; i++) {
        if (this.textLinkCats[catKeyword]['is_fixed'])
          fixedCatKeywords.push(catKeyword);
      }

      var buildTabString = (catKeyword, catTitle) => {
        return `<div class="tab" data-cat="${catKeyword}">${catTitle}</div>`;
      }
      var tabStripInnerHTML = '';
      for (var i = 0, catKeyword; catKeyword = fixedCatKeywords[i]; i++) {
        tabStripInnerHTML +=
            buildTabString(catKeyword, this.textLinkCats[catKeyword]['cat_title']);
      }
      for (var i = 0, catKeyword; catKeyword = this.selectedCatKeywords[i]; i++) {
        if (!this.textLinkCats[catKeyword])
          continue;
        tabStripInnerHTML +=
            buildTabString(catKeyword, this.textLinkCats[catKeyword]['cat_title']);
      }
      tabStripInnerHTML += `<div class="tab more">···</div>`;
      this.tabStrip.innerHTML = tabStripInnerHTML;

      var currentCat = null;
      for (var i = 0, catKeyword; catKeyword = fixedCatKeywords[i]; i++) {
        if (this.currentCatKeyword == catKeyword) {
          currentCat = catKeyword;
          break;
        }
      }
      if (!currentCat) {
        for (var i = 0, catKeyword; catKeyword = this.selectedCatKeywords[i]; i++) {
          if (this.currentCatKeyword == catKeyword) {
            currentCat = catKeyword;
            break;
          }
        }
      }

      this.showTabPage(currentCat ||
                       (fixedCatKeywords ? fixedCatKeywords[0]
                                         : this.selectedCatKeywords[0]));
      this.updateTextLinkTabStripShadow();
      $('text-link-section').hidden = false;
      if (window.onresize)
        window.onresize();
    },
    getJsonObjFromLocalStorage_: function(key) {
      var obj = null;
      try {
        var temp = localStorage.getItem(key);
        if (temp)
          obj = JSON.parse(temp);
      } catch (e) {
      }
      return obj;
    },
    getCachedCats: function() {
      return this.getJsonObjFromLocalStorage_('cats');
    },
    tryToBuildFromCache: function() {
      if (this.succeededToBuildFromCached)
        return true;

      var cachedCats = this.getCachedCats();
      if (!cachedCats)
        return false;

      this.textLinkCats = cachedCats;
      var self = this;
      asyncHelper.sendAndReceive('getSelectedCats', [],
                                 (isDefaultSelectedCats, selectedCatKeywords)=>{

        // If the user nerver sets cats, we use the default.
        self.selectedCatKeywords = isDefaultSelectedCats
            ? cachedCats['default_selected_cat_keywords']
            : selectedCatKeywords;
        self.currentCatKeyword = localStorage.getItem('currentSelectedCat');
        self.build();
      });

      // this.selectedCatKeywords =
      //     selectedCatKeywords || cachedCats['default_selected_cat_keywords'];
      // this.currentCatKeyword = localStorage.getItem('currentSelectedCat');
      // this.build();
      this.succeededToBuildFromCached = true;
      return true;
    },
    buildFromDefault: function() {
      var self = this;
      asyncHelper.sendAndReceive('getTextLinks', [],
                                 (textLinkCats, selectedCatKeywords)=>{
        self.textLinkCats = textLinkCats;
        self.selectedCatKeywords = selectedCatKeywords;
        self.currentCatKeyword = localStorage.getItem('currentSelectedCat');
        self.build();
      });
    },
    setCatConfig: function(cats) {
      if (this.succeededToBuildFromCached) {
        if (cats)
          localStorage.setItem('cats', JSON.stringify(cats));
        return;
      }
      if (cats) {
        this.textLinkCats = cats;
        this.selectedCatKeywords = cats['default_selected_cat_keywords'];
        this.currentCatKeyword = localStorage.getItem('currentSelectedCat');
        this.build();
        localStorage.setItem('cats', JSON.stringify(cats));
        return;
      }
      this.buildFromDefault();
    },
    // |isDefault| can be true if the user imports settings and it is explicitly true.
    updateSelectedCats: function(isDefault, selectedCats) {
      var newSelectedCats = selectedCats;
      if (isDefault && this.succeededToBuildFromCached) {
        var cachedCats = this.getCachedCats();
        if (cachedCats && cachedCats['default_selected_cat_keywords'])
          newSelectedCats = cachedCats['default_selected_cat_keywords'];
      }

      if (this.selectedCatKeywords.toString() == selectedCats.toString())
        return;

      this.selectedCatKeywords = selectedCats;
      this.build();
    }
  };
  /// }
  

  $('img-link-section').addEventListener('click', function(e) {
    var a = null;

    if (e.target.tagName == 'A' && e.target.parentNode.classList.contains('title'))
        a = e.target;

    if (!a && e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('img-a'))
        a = e.target.parentNode;

    if (!a && e.target.tagName == 'DIV' && e.target.classList.contains('title') && e.target.parentNode.tagName == 'A')
        a = e.target.parentNode;

    if (!a)
        return;

    var imgItem = null;
    var ele = a;
    while (ele) {
      if (ele.classList.contains('img-item')) {
        imgItem = ele;
        break;
      }
      ele = ele.parentNode;
    }
    if (imgItem) {
      chrome.send('reportLinkClicked', [1, imgItem.dataset.title, imgItem.dataset.url]);
    }
  });

  $('text-link-section').addEventListener('click', function(e) {
    if (e.target.tagName == 'A') {
      chrome.send('reportLinkClicked', [2, e.target.title, e.target.href]);
    }
  });
  function setSearchSectionHeight(height) {
    var showSearchLogo = false;
    if (height < 150) {
      height = 0;
      showSearchLogo = false;
    } else {
      showSearchLogo = true;
    }
    $('search-logo').style.opacity = showSearchLogo ? '1' : '0';
    $('search-section').style.height = height + 'px';
    localStorage.setItem('searchSectionHeight', height);
  }
  function updatedSearchSectionSize() {
    var searchSuggestion = $('search-suggestion');
    if (searchSuggestion.hidden == false)
      searchSuggestion.style.width = ($('search-input').offsetWidth - 2) + 'px';

    var clientHeight = document.documentElement.clientHeight;
    var imgSectionHeight = $('img-link-section').offsetHeight;
    var textSectionHeight = $('text-link-section').offsetHeight;
    if (imgSectionHeight < 100 || textSectionHeight < 100)
      return;
    var otherHeight = imgSectionHeight + 50 + textSectionHeight + 30;
    var searchSectionHeight = (clientHeight - otherHeight) * 3 / 5;
    setSearchSectionHeight(searchSectionHeight);
  }

  function onPageResize() {
    document.body.classList.toggle('small-screen', window.screen.availWidth < 1500);
    
    updatedSearchSectionSize();

    textLinkSection.updateTextLinkTabStripShadow();
  }

  var jsonPConfigScriptElement = null;
  var jsonPConfigCallback = null;
  function requestConfig(callback) {
    setTimeout(()=>{
      if (jsonPConfigScriptElement) {
        cr.doc.head.removeChild(jsonPConfigScriptElement);
      }
      jsonPConfigCallback = callback;

      var url = `${kWebsite}/ntpconfex.js?union_id=${loadTimeData.getInteger('unionID')}&bversion=${tsbrowser.getVersion()}&t=${Date.now()}`;
      jsonPConfigScriptElement = cr.doc.createElement('script');
      jsonPConfigScriptElement.async = true;
      jsonPConfigScriptElement.setAttribute('src', url);
      jsonPConfigScriptElement.onerror = ()=>{
        callback(null);
      }
      cr.doc.head.appendChild(jsonPConfigScriptElement);
    }, 0);
  }
  function onNewConfig(data) {
    if (typeof jsonPConfigCallback != 'function')
      return;

    var obj = null;
    try {
      if (data)
        obj = JSON.parse(data)
    } catch (e) {
    }
    jsonPConfigCallback(obj);
  }

  function setSearchConfig(searchConfig) {
    if (searchConfig && searchConfig['use_account'] && searchConfig['account']) {
      searchEngine.useAccount = true;
      searchEngine.account = searchConfig['account'];
      return;
    }

    searchEngine.useAccount = false;
    searchEngine.account = '';
  }

  /**
   * Invoked at startup once the DOM is available to initialize the app.
   */
  function onLoad() {
    if (window.location.host != 'newtab')
      return;

    chrome.send('showGuideCoverIfNecessary');

    $('search-section').hidden = false;
    setSearchSectionHeight((localStorage.getItem('searchSectionHeight') || 0) - 0);
    
    // Load the current theme colors.
    themeChanged();
    chrome.send('getThemeSettings');

    initSearch();

    imageLinkSection = new ImageLinkSection();
    chrome.send('getDisplayImageLinks');
    // asyncHelper.sendAndReceive('getDisplayImageLinks', [], function(args) {
    //   imageLinkSection.updateImageLink(args);
    // })

    textLinkSection = new TextLinkSection();
    textLinkSection.tryToBuildFromCache();
    requestConfig((config)=>{
      if (!config) {
        textLinkSection.setCatConfig(null);
        return;
      }

      setSearchConfig(config['search']);
      textLinkSection.setCatConfig(config['cats']);
    });

    urlEditor = new UrlEditor_();
    urlEditor.initialize();
    urlTabSelector = new UrlTabSelector_();
    urlTabSelector.initialize();

    topNavigator = new TopNavigator_();
    topNavigator.initialize();
    asyncHelper.sendAndReceive('getNTPThemeBackgroundColor', [], (data)=>{
      topNavigator.ntpThemeBGColor = data;
    })

    window.addEventListener('resize', onPageResize)

    onPageResize();
    setTimeout(onPageResize, 1000);
    setTimeout(onPageResize, 3000);
  }

  /**
   * Called when the theme has changed.
   * @param {Object=} opt_themeData Not used; only exists to match equivalent
   *     function in incognito NTP.
   */
  function themeChanged(opt_themeData) {
    $('themecss').href = 'chrome://theme/css/new_tab_theme.css?' + Date.now();
    chrome.send('getUseNTPThemeBGColor');
  }

  function onNewThemeSettingsChanged(themeSettings) {
    topNavigator.setNewThemeSettings(themeSettings);
  }

  function onUseNTPThemeBGColorChanged(data) {
    topNavigator.setUseNTPThemeBGColor(data[0]);
  }

  function updateImageLink(args) {
    imageLinkSection.updateImageLink(args);
  }

  function updateTextLinksSectionSelectedCats(isDefault, selectedCats) {
    textLinkSection.updateSelectedCats(isDefault, selectedCats);
  }

  // Return an object with all the exports
  return {
    onLoad: onLoad,
    themeChanged: themeChanged,
    onNewThemeSettingsChanged: onNewThemeSettingsChanged,
    onNewConfig: onNewConfig,
    setBookmarkBarAttached: setBookmarkBarAttached,
    onUseNTPThemeBGColorChanged: onUseNTPThemeBGColorChanged,
    updateImageLink: updateImageLink,
    updateTextLinksSectionSelectedCats: updateTextLinksSectionSelectedCats,
  };
});

document.addEventListener('DOMContentLoaded', ntp.onLoad);

function new_config(data) {
  ntp.onNewConfig(data);
}

console.log("%c Be a great maker!",
            "font-size:50px;color:red;text-fill-color:red;-webkit-text-stroke: 1px black;")</script>

</body>
</html>
<script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

/**
 * @fileoverview This file defines a singleton which provides access to all data
 * that is available as soon as the page's resources are loaded (before DOM
 * content has finished loading). This data includes both localized strings and
 * any data that is important to have ready from a very early stage (e.g. things
 * that must be displayed right away).
 *
 * Note that loadTimeData is not guaranteed to be consistent between page
 * refreshes (https://crbug.com/740629) and should not contain values that might
 * change if the page is re-opened later.
 */

/**
 * @typedef {{
 *   substitutions: (Array<string>|undefined),
 *   attrs: (Object<function(Node, string):boolean>|undefined),
 *   tags: (Array<string>|undefined),
 * }}
 */
var SanitizeInnerHtmlOpts;

/** @type {!LoadTimeData} */ var loadTimeData;

// Expose this type globally as a temporary work around until
// https://github.com/google/closure-compiler/issues/544 is fixed.
/** @constructor */
function LoadTimeData(){}

(function() {
  'use strict';

  LoadTimeData.prototype = {
    /**
     * Sets the backing object.
     *
     * Note that there is no getter for |data_| to discourage abuse of the form:
     *
     *     var value = loadTimeData.data()['key'];
     *
     * @param {Object} value The de-serialized page data.
     */
    set data(value) {
      expect(!this.data_, 'Re-setting data.');
      this.data_ = value;
    },

    /**
     * Returns a JsEvalContext for |data_|.
     * @returns {JsEvalContext}
     */
    createJsEvalContext: function() {
      return new JsEvalContext(this.data_);
    },

    /**
     * @param {string} id An ID of a value that might exist.
     * @return {boolean} True if |id| is a key in the dictionary.
     */
    valueExists: function(id) {
      return id in this.data_;
    },

    /**
     * Fetches a value, expecting that it exists.
     * @param {string} id The key that identifies the desired value.
     * @return {*} The corresponding value.
     */
    getValue: function(id) {
      expect(this.data_, 'No data. Did you remember to include strings.js?');
      var value = this.data_[id];
      expect(typeof value != 'undefined', 'Could not find value for ' + id);
      return value;
    },

    /**
     * As above, but also makes sure that the value is a string.
     * @param {string} id The key that identifies the desired string.
     * @return {string} The corresponding string value.
     */
    getString: function(id) {
      var value = this.getValue(id);
      expectIsType(id, value, 'string');
      return /** @type {string} */ (value);
    },

    /**
     * Returns a formatted localized string where $1 to $9 are replaced by the
     * second to the tenth argument.
     * @param {string} id The ID of the string we want.
     * @param {...(string|number)} var_args The extra values to include in the
     *     formatted output.
     * @return {string} The formatted string.
     */
    getStringF: function(id, var_args) {
      var value = this.getString(id);
      if (!value)
        return '';

      var args = Array.prototype.slice.call(arguments);
      args[0] = value;
      return this.substituteString.apply(this, args);
    },

    /**
     * Make a string safe for use with with Polymer bindings that are
     * inner-h-t-m-l (or other innerHTML use).
     * @param {string} rawString The unsanitized string.
     * @param {SanitizeInnerHtmlOpts=} opts Optional additional allowed tags and
     *     attributes.
     * @return {string}
     */
    sanitizeInnerHtml: function(rawString, opts) {
      opts = opts || {};
      return parseHtmlSubset('<b>' + rawString + '</b>', opts.tags, opts.attrs)
          .firstChild.innerHTML;
    },

    /**
     * Returns a formatted localized string where $1 to $9 are replaced by the
     * second to the tenth argument. Any standalone $ signs must be escaped as
     * $$.
     * @param {string} label The label to substitute through.
     *     This is not an resource ID.
     * @param {...(string|number)} var_args The extra values to include in the
     *     formatted output.
     * @return {string} The formatted string.
     */
    substituteString: function(label, var_args) {
      var varArgs = arguments;
      return label.replace(/\$(.|$|\n)/g, function(m) {
        assert(m.match(/\$[$1-9]/), 'Unescaped $ found in localized string.');
        return m == '$$' ? '$' : varArgs[m[1]];
      });
    },

    /**
     * Returns a formatted string where $1 to $9 are replaced by the second to
     * tenth argument, split apart into a list of pieces describing how the
     * substitution was performed. Any standalone $ signs must be escaped as $$.
     * @param {string} label A localized string to substitute through.
     *     This is not an resource ID.
     * @param {...(string|number)} var_args The extra values to include in the
     *     formatted output.
     * @return {!Array<!{value: string, arg: (null|string)}>} The formatted
     *     string pieces.
     */
    getSubstitutedStringPieces: function(label, var_args) {
      var varArgs = arguments;
      // Split the string by separately matching all occurrences of $1-9 and of
      // non $1-9 pieces.
      var pieces = (label.match(/(\$[1-9])|(([^$]|\$([^1-9]|$))+)/g) ||
                    []).map(function(p) {
        // Pieces that are not $1-9 should be returned after replacing $$
        // with $.
        if (!p.match(/^\$[1-9]$/)) {
          assert(
              (p.match(/\$/g) || []).length % 2 == 0,
              'Unescaped $ found in localized string.');
          return {value: p.replace(/\$\$/g, '$'), arg: null};
        }

        // Otherwise, return the substitution value.
        return {value: varArgs[p[1]], arg: p};
      });

      return pieces;
    },

    /**
     * As above, but also makes sure that the value is a boolean.
     * @param {string} id The key that identifies the desired boolean.
     * @return {boolean} The corresponding boolean value.
     */
    getBoolean: function(id) {
      var value = this.getValue(id);
      expectIsType(id, value, 'boolean');
      return /** @type {boolean} */ (value);
    },

    /**
     * As above, but also makes sure that the value is an integer.
     * @param {string} id The key that identifies the desired number.
     * @return {number} The corresponding number value.
     */
    getInteger: function(id) {
      var value = this.getValue(id);
      expectIsType(id, value, 'number');
      expect(value == Math.floor(value), 'Number isn\'t integer: ' + value);
      return /** @type {number} */ (value);
    },

    /**
     * Override values in loadTimeData with the values found in |replacements|.
     * @param {Object} replacements The dictionary object of keys to replace.
     */
    overrideValues: function(replacements) {
      expect(
          typeof replacements == 'object',
          'Replacements must be a dictionary object.');
      for (var key in replacements) {
        this.data_[key] = replacements[key];
      }
    }
  };

  /**
   * Checks condition, displays error message if expectation fails.
   * @param {*} condition The condition to check for truthiness.
   * @param {string} message The message to display if the check fails.
   */
  function expect(condition, message) {
    if (!condition) {
      console.error(
          'Unexpected condition on ' + document.location.href + ': ' + message);
    }
  }

  /**
   * Checks that the given value has the given type.
   * @param {string} id The id of the value (only used for error message).
   * @param {*} value The value to check the type on.
   * @param {string} type The type we expect |value| to be.
   */
  function expectIsType(id, value, type) {
    expect(
        typeof value == type, '[' + value + '] (' + id + ') is not a ' + type);
  }

  expect(!loadTimeData, 'should only include this file once');
  loadTimeData = new LoadTimeData;
})();
</script><script>loadTimeData.data = {"addUrl":"添加网址","anim":true,"appDefaultPageName":"应用","appInstallHintText":"添加更多应用","appcreateshortcut":"创建快捷方式…","appdetails":"在 极速浏览器 网上应用店中查看","appinfodialog":"应用信息","applaunchtypefullscreen":"以全屏模式打开","applaunchtypepinned":"在固定标签页中打开","applaunchtyperegular":"在常规标签页中打开","applaunchtypewindow":"在窗口中打开","appoptions":"选项","appuninstall":"从极速浏览器中移除…","attributionintro":"主题背景创建者：","bookmarkbarattached":"true","canHostedAppsOpenInWindows":true,"canShowAppInfoDialog":true,"cancel":"取消","confirm":"确认","currentlyOpened":"当前打开","editUrl":"编辑网址","enableNewBookmarkApps":true,"fontfamily":"'Segoe UI',Arial,'Microsoft Yahei',sans-serif","fontsize":"75%","isSwipeTrackingFromScrollEventsEnabled":false,"isUserSignedIn":false,"language":"zh","learnMore":"了解详情","learn_more":"了解详情","login_status_advanced":"","login_status_dismiss":"","login_status_message":"","login_status_url":"","mostVisited":"常去网站","no_most_visited_websites":"无最常访问网站","only_newtab_page_is_opened":"当前仅打开新标签页","page_switcher_change_title":"转到“$1”","page_switcher_same_title":"更多“$1”","popular":"热门网址","search":"搜索","shouldShowSyncLogin":true,"showWebStoreIcon":true,"shown_page_index":0,"syncLinkText":"高级设置","syncpromotext":"登录$1","textdirection":"ltr","tile_grid_screenreader_accessible_description":"使用左右箭头键进行导航。","title":"新标签页","unionID":898,"urlLink":"网址：","urlTitle":"标题：","webStoreLink":"https://chrome.google.com/webstore?hl=zh-CN","webStoreTitle":"极速浏览器 网上应用店","webStoreTitleShort":"极速浏览器 网上应用店"};</script><script>// Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// Note: vulcanize sometimes disables GRIT processing. If you're importing i18n
// stuff with <link rel="import">, you should probably be using
// html/i18n_template.html instead of this file.

// // Copyright (c) 2012 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

/** @typedef {Document|DocumentFragment|Element} */
var ProcessingRoot;

/**
 * @fileoverview This is a simple template engine inspired by JsTemplates
 * optimized for i18n.
 *
 * It currently supports three handlers:
 *
 *   * i18n-content which sets the textContent of the element.
 *
 *     <span i18n-content="myContent"></span>
 *
 *   * i18n-options which generates <option> elements for a <select>.
 *
 *     <select i18n-options="myOptionList"></select>
 *
 *   * i18n-values is a list of attribute-value or property-value pairs.
 *     Properties are prefixed with a '.' and can contain nested properties.
 *
 *     <span i18n-values="title:myTitle;.style.fontSize:fontSize"></span>
 *
 * This file is a copy of i18n_template.js, with minor tweaks to support using
 * load_time_data.js. It should replace i18n_template.js eventually.
 */

var i18nTemplate = (function() {
  /**
   * This provides the handlers for the templating engine. The key is used as
   * the attribute name and the value is the function that gets called for every
   * single node that has this attribute.
   * @type {!Object}
   */
  var handlers = {
    /**
     * This handler sets the textContent of the element.
     * @param {!HTMLElement} element The node to modify.
     * @param {string} key The name of the value in |data|.
     * @param {!LoadTimeData} data The data source to draw from.
     * @param {!Set<ProcessingRoot>} visited
     */
    'i18n-content': function(element, key, data, visited) {
      element.textContent = data.getString(key);
    },

    /**
     * This handler adds options to a <select> element.
     * @param {!HTMLElement} select The node to modify.
     * @param {string} key The name of the value in |data|. It should
     *     identify an array of values to initialize an <option>. Each value,
     *     if a pair, represents [content, value]. Otherwise, it should be a
     *     content string with no value.
     * @param {!LoadTimeData} data The data source to draw from.
     * @param {!Set<ProcessingRoot>} visited
     */
    'i18n-options': function(select, key, data, visited) {
      var options = data.getValue(key);
      options.forEach(function(optionData) {
        var option = typeof optionData == 'string' ?
            new Option(optionData) :
            new Option(optionData[1], optionData[0]);
        select.appendChild(option);
      });
    },

    /**
     * This is used to set HTML attributes and DOM properties. The syntax is:
     *   attributename:key;
     *   .domProperty:key;
     *   .nested.dom.property:key
     * @param {!HTMLElement} element The node to modify.
     * @param {string} attributeAndKeys The path of the attribute to modify
     *     followed by a colon, and the name of the value in |data|.
     *     Multiple attribute/key pairs may be separated by semicolons.
     * @param {!LoadTimeData} data The data source to draw from.
     * @param {!Set<ProcessingRoot>} visited
     */
    'i18n-values': function(element, attributeAndKeys, data, visited) {
      var parts = attributeAndKeys.replace(/\s/g, '').split(/;/);
      parts.forEach(function(part) {
        if (!part)
          return;

        var attributeAndKeyPair = part.match(/^([^:]+):(.+)$/);
        if (!attributeAndKeyPair)
          throw new Error('malformed i18n-values: ' + attributeAndKeys);

        var propName = attributeAndKeyPair[1];
        var propExpr = attributeAndKeyPair[2];

        var value = data.getValue(propExpr);

        // Allow a property of the form '.foo.bar' to assign a value into
        // element.foo.bar.
        if (propName[0] == '.') {
          var path = propName.slice(1).split('.');
          var targetObject = element;
          while (targetObject && path.length > 1) {
            targetObject = targetObject[path.shift()];
          }
          if (targetObject) {
            targetObject[path] = value;
            // In case we set innerHTML (ignoring others) we need to recursively
            // check the content.
            if (path == 'innerHTML') {
              for (var i = 0; i < element.children.length; ++i) {
                processWithoutCycles(element.children[i], data, visited, false);
              }
            }
          }
        } else {
          element.setAttribute(propName, /** @type {string} */ (value));
        }
      });
    }
  };

  var prefixes = [''];

  // Only look through shadow DOM when it's supported. As of April 2015, iOS
  // Chrome doesn't support shadow DOM.
  if (Element.prototype.createShadowRoot)
    prefixes.push('* /deep/ ');

  var attributeNames = Object.keys(handlers);
  var selector = prefixes
                     .map(function(prefix) {
                       return prefix + '[' +
                           attributeNames.join('], ' + prefix + '[') + ']';
                     })
                     .join(', ');

  /**
   * Processes a DOM tree using a |data| source to populate template values.
   * @param {!ProcessingRoot} root The root of the DOM tree to process.
   * @param {!LoadTimeData} data The data to draw from.
   */
  function process(root, data) {
    processWithoutCycles(root, data, new Set(), true);
  }

  /**
   * Internal process() method that stops cycles while processing.
   * @param {!ProcessingRoot} root
   * @param {!LoadTimeData} data
   * @param {!Set<ProcessingRoot>} visited Already visited roots.
   * @param {boolean} mark Whether nodes should be marked processed.
   */
  function processWithoutCycles(root, data, visited, mark) {
    if (visited.has(root)) {
      // Found a cycle. Stop it.
      return;
    }

    // Mark the node as visited before recursing.
    visited.add(root);

    var importLinks = root.querySelectorAll('link[rel=import]');
    for (var i = 0; i < importLinks.length; ++i) {
      var importLink = /** @type {!HTMLLinkElement} */ (importLinks[i]);
      if (!importLink.import) {
        // Happens when a <link rel=import> is inside a <template>.
        // TODO(dbeam): should we log an error if we detect that here?
        continue;
      }
      processWithoutCycles(importLink.import, data, visited, mark);
    }

    var templates = root.querySelectorAll('template');
    for (var i = 0; i < templates.length; ++i) {
      var template = /** @type {HTMLTemplateElement} */ (templates[i]);
      if (!template.content)
        continue;
      processWithoutCycles(template.content, data, visited, mark);
    }

    var isElement = root instanceof Element;
    if (isElement && root.webkitMatchesSelector(selector))
      processElement(/** @type {!Element} */ (root), data, visited);

    var elements = root.querySelectorAll(selector);
    for (var i = 0; i < elements.length; ++i) {
      processElement(elements[i], data, visited);
    }

    if (mark) {
      var processed = isElement ? [root] : root.children;
      if (processed) {
        for (var i = 0; i < processed.length; ++i) {
          processed[i].setAttribute('i18n-processed', '');
        }
      }
    }
  }

  /**
   * Run through various [i18n-*] attributes and populate.
   * @param {!Element} element
   * @param {!LoadTimeData} data
   * @param {!Set<ProcessingRoot>} visited
   */
  function processElement(element, data, visited) {
    for (var i = 0; i < attributeNames.length; i++) {
      var name = attributeNames[i];
      var attribute = element.getAttribute(name);
      if (attribute != null)
        handlers[name](element, attribute, data, visited);
    }
  }

  return {process: process};
}());

// // Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

i18nTemplate.process(document, loadTimeData);

</script>
